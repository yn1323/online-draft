---
description: "あなたの分身として、文脈を考慮した実用的なリファクタリングを実行"
---

# 🔄 リファクタリング実行（あなたの分身モード）

対象: $ARGUMENTS

## 🎯 リファクタリングの哲学

**「今の挙動そのまま」でコードをきれいにする。機能的には一切変えずに、コードの見た目や構造だけを改善する。**

- ❌ バグは直さない
- ✅ 副次的な効果でパフォーマンスが上がることはある
- 🎯 **文脈を考慮した実用的な判断**を最優先

## 🧠 判断基準（あなたの思考プロセス）

### 共通化の判断
**「ときと場合による」を基準に文脈重視で決める：**

✅ **積極的に共通化するもの：**
- ほぼ同じコンポーネント（UserProfile vs UserCard のような重複）
- 頻繁に使う処理（fetch、API呼び出し等）→ 超汎用化して外だし
- バリデーション等の純粋関数 → **テストしやすさ重視**で別ファイルに外だし
- UI部品（input、button等）→ 汎用コンポーネント化

❌ **共通化しないもの：**
- ドメイン固有の部分（責務が違うから）
- form全体（それぞれの責務が明確に違う）
- 1つのファイル内の関数（ファイル内での重複は許容）
- 無理な定数化（文脈上自然でないもの）

🎯 **柔軟対応：**
- ロジック、HTML、CSSの共通化は積極的に
- 同じファイル内のコンポーネントと関数の共存はOK

### 関数分割の判断
**Step Down Rule（段階的抽象化）を重視：**

- **「全体を見たい」と「詳細を見たい」が混在している** → 分割対象
- 上から下に「だんだん詳細になっていく」構造にする
- public関数（高レベル・抽象的）→ private関数（詳細・具体的）
- **テストしやすい形に分割**（特にMSW利用時のC/Pパターン）

## 📝 ネーミング改善（一貫性最優先）

### 基本ルール
- **具体的な名前**：`data` → `userData`
- **省略形禁止**：`btn` → `button`
- **動詞vs名詞**：関数は動詞始まり、変数・定数は名詞
- **複数形統一**：基本`-s`、難しいときのみ`-List`
- **ドメイン用語は絶対統一**：プロジェクト内で同じ概念は同じ名前

### Boolean命名
- **基本**：`is〜`
- **所有・存在**：`has〜`（hasPermission、hasChildren）
- **能力**：`can〜`（canEdit、canDelete）
- **義務**：`should〜`（shouldValidate）
- **否定**：`isDisabled`（`isNot〜`は避ける）

## 🏗️ 技術的指針

### 優先する構造
- **関数ベース** > class（classは避ける）
- **テスタビリティ**を常に考慮
- **関心の分離**だけど過度なモジュール化は避ける
- **エラーハンドリング**：汎用的な部分は共通化、具体的な扱いはドメインロジック側

### コメント・ドキュメント方針
- **「コードで語る」**を基本とする
- 既存コメントは見直し、不要なものは削除
- Step Down Ruleに従い、関数名で意図を表現
- 自明でない複雑なロジックにのみ最小限のコメント
- ドメイン知識が必要な部分は適切にドキュメント化

## 🚀 実行スタイル

### コミュニケーション
- **理由付きで積極的に提案**（「〜だから〜しましょう」）
- **段階的に確認**しながら進める
- **時間がかかる作業は事前に報告**
- 迷ったときは選択肢を提示（「A案とB案どちらがいいですか？」）

### 作業の進め方
1. **現状分析**：対象コードの構造と問題点を特定
2. **優先順位付け**：最も効果的な改善から順番に
3. **段階的実行**：一度にすべてではなく、確認しながら
4. **テスト重視**：リファクタ前後で挙動が変わらないことを確認

## 🎯 今すぐ開始

対象コード（$ARGUMENTS）を分析して、あなたの思考プロセスに従って段階的にリファクタリングを実行します。

**最初に現状分析を行い、改善点を優先順位付けして提案します。理由と共に説明するので、一つずつ確認しながら進めましょう！**
# オンラインドラフト会議 要件定義書

## 🎯 プロジェクト概要

オンラインドラフト会議は、リアルタイムマルチプレイヤー対応の汎用ドラフトゲームプラットフォームです。
URLシェアによる簡単参加と音声通話併用を前提とした、シンプルで使いやすいドラフト体験を提供します。

### プロダクトビジョン
「友人同士が音声通話しながら、URLシェアだけで手軽に参加できるドラフトゲーム体験を提供し、どんなジャンルでも盛り上がれる汎用プラットフォームを目指す」

### 解決する課題
- 既存のドラフトゲームは登録が面倒
- 特定ジャンルに特化しすぎて汎用性がない
- オフライン開催は場所の制約がある
- リアルタイム性がないと盛り上がりに欠ける

## 📋 基本コンセプト

### ドラフト対象
- **汎用プラットフォーム**: POG（競馬）、野球、アイドル等、あらゆるジャンルに対応
- **自由入力形式**: 参加者が自由にドラフト対象を持ち寄り
- **事前相談前提**: 何をドラフトするかは参加者同士で事前決定

### 参加方式
- **URLシェア**: 登録不要、URLを共有するだけで参加可能
- **音声通話併用**: LINE通話、Skype等との併用を前提
- **リアルタイム同期**: Firebase Firestoreによるリアルタイム状態共有

### プレイヤー規模
- **対象人数**: 4-8人
- **時間制限**: なし（参加者の自由なペースで進行）

## 👥 ターゲットユーザー

### 対象ユーザー
- 既存の友人グループ
- スポーツファン同士
- ゲーム・アニメ愛好者
- 職場・サークルメンバー
- ネット上のコミュニティ

### 利用シーン
- 定期的な集まり時
- 新シーズン・新作リリース等のイベント時
- 計画的なドラフト開催
- 思いつきでの突発的な利用

### デバイス対応
- **メイン**: スマートフォン
- **サブ**: PC（デスクトップ・ノート）
- **対象外**: タブレット専用レイアウトは不要

## 🎮 ドラフトの基本ルール

### ドラフト方式
- **一斉入力方式**: 従来の順番制ではなく、各巡目で全員が同時に選択
- **競合解決**: ランダム抽選による解決
- **再選択**: 競合敗者は同一巡目内で別選択肢を選択可能

### ゲームフロー
1. **ホストがルーム作成** → URLシェア
2. **参加者が順次参加** → 即座にドラフト開始可能
3. **ドラフト実行** （以下の流れを巡目数分繰り返し）
   - 各自入力フェーズ（各自のタイミングで選択肢入力）
   - 開票待機フェーズ（全員の入力完了待ち）
   - 開票フェーズ（一斉開票・演出付き）
   - 結果確認フェーズ（取得成功・失敗の確認）
   - 再選択フェーズ（競合発生時のみ、敗者が別選択肢を入力）

## 🛠️ 技術要件

### フロントエンド
- Next.js 15 (App Router)
- React 19
- TypeScript
- Chakra UI v3
- Jotai（状態管理）

### バックエンド
- Firebase Firestore（リアルタイムデータベース）
- Firebase Anonymous Auth（匿名認証）

### レスポンシブ対応
- 2段階ブレイクポイント（SP/PC）
- スマートフォンファースト設計

### アニメーション・演出
- Framer Motion
- 150ms統一のアニメーション時間
- 開票演出によるゲーム体験向上

## 🎯 成功指標

### ユーザー体験
- URLシェアから参加まで30秒以内
- 全ての操作でリアルタイム同期
- 直感的で分かりやすいUI
- 盛り上がる開票演出

### 技術的指標
- 4-8人同時接続での安定動作
- レスポンシブ対応（SP/PC）
- TypeScript厳格モードでのエラーゼロ
- E2Eテストによる基本フローの動作保証

## 📚 用語定義

### 基本用語
- **ドラフト**: 参加者が順番または同時に、共通のプール（選択肢群）から欲しいアイテムを選択していくゲーム形式
- **巡目（ラウンド）**: ドラフトの1回分の選択機会。全参加者が1つずつ選択することで1巡目が完了
- **競合**: 同一巡目で複数の参加者が同じアイテムを選択してしまうこと
- **開票**: 各巡目で参加者の選択を一斉に公開すること

### システム用語
- **ルーム**: ドラフトを実行する単位。1つのグループが1つのルームでドラフトを実行
- **ホスト**: ルームを作成したユーザー（ただし、特別な権限は持たない）
- **参加者**: ルームに参加してドラフトに参加するユーザー
- **入力フェーズ**: 各巡目で参加者が選択を入力する期間
- **開票フェーズ**: 全員の入力完了後、選択内容を一斉公開する演出期間

## 🎯 具体的なユースケースシナリオ

### シナリオ1: 野球ファングループのドラフト
**参加者**: 6人の野球ファン友人グループ
**対象**: 2024年プロ野球選手
**時期**: シーズン開始前

1. 幹事Aがルーム作成「2024プロ野球ドラフト」
2. LINEグループにURL共有
3. 各自が好きなタイミングで参加、アバター選択
4. 全員揃ったらドラフト開始（5巡目まで実施）
5. 各巡目で好きな選手を選択
6. 競合した場合はランダムで決定
7. チャットで「その選手狙ってた〜」等でワイワイ
8. シーズン中に振り返って盛り上がり

### シナリオ2: アニメファンのキャラドラフト
**参加者**: 4人のアニメ好き
**対象**: 今期アニメキャラクター
**時期**: 新アニメクール開始時

1. Discord通話しながらドラフト実施
2. 各自が推しキャラをコメント付きで選択
3. 「このキャラ絶対活躍する！」等の予想コメント
4. 次クールに結果を振り返り

### シナリオ3: 職場メンバーの楽曲ドラフト
**参加者**: 8人の同僚
**対象**: 今年リリースされた楽曲
**時期**: 年末

1. 昼休みにサクッと実施
2. 各自のお気に入り楽曲を選択
3. 後日プレイリスト作成

## 🚫 制約事項・非機能要件

### システム制約
- **参加人数**: 最小2人、最大8人
- **同時接続数**: ルーム内最大8人（技術制約）

### セキュリティ
- **匿名認証**: Firebaseの匿名認証を使用
- **アクセス制御**: ルームIDを知る人のみ参加可能
- **データ暗号化**: Firebase標準の暗号化
- **個人情報**: ユーザー名以外の個人情報は収集しない

## ⚠️ エッジケース・例外処理

### 参加者関連
- **再参加**: 同一ルームに再参加可能（同じユーザー名で）
- **アバター重複**: 早い者勝ち、後から参加者は別のアバターを選択

### 通信・技術関連
- **接続断**: 自動再接続を試行、復旧時はトースト通知
- **入力中の接続断**: 再接続時に入力内容は消失（仕様）
- **全員接続断**: ルーム状態は保持、再接続時に復旧

### ドラフト進行関連
- **全員同じアイテム選択**: ランダムで1人が獲得、残りは再選択
- **入力なしユーザー**: 一定時間後にスキップ扱い（未実装、将来対応）
- **空文字入力**: バリデーションエラー、再入力を促す
- **巡目数の変更**: ドラフト開始後の変更は可能。ただしログで変更内容を出力する

### データ関連
- **特殊文字入力**: 絵文字・記号は使用可能
- **重複アイテム名**: 同一参加者による重複選択は許可
- **大量データ**: アイテム名・コメントの文字数制限で対応

## 🔒 システム境界・対象外

### 対象外機能
- **ユーザー登録・ログイン**: 匿名参加のみ
- **課金・決済**: 完全無料
- **SNS連携**: URL共有のみ
- **通知機能**: アプリ内通知のみ
- **履歴管理**: 基本的な保存のみ、検索・分析は対象外
- **マルチプラットフォーム**: Web版のみ、ネイティブアプリは対象外

### 外部システム連携
- **音声通話**: 外部サービス（LINE、Discord等）を前提
- **データ分析**: 対象外（将来的な拡張可能性あり）
- **外部API**: 対象外（すべて手動入力）

---

*この要件定義書は、プロジェクトの進行とともに継続的に更新・改善されます。*
*最終更新: 2025年6月*
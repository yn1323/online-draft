# アプリケーション仕様書

## 🎯 最終仕様まとめ（推しを選んで、かぶったら勝負！）

### 🎯 コンセプト
**「推しを選んで、かぶったら勝負！」みんなでワイワイドラフト会議 🎉**

#### 🍺 このアプリの楽しみ方
- **選ぶ**: 好きなもの選んで自己主張！
- **かぶる**: 「えー！それ俺も！」で盛り上がる
- **勝負**: スロットでドキドキ演出（実は既に決まってるけどｗ）
- **雑談**: チャットでワイワイ、選択理由で議論白熱

#### 😊 ゆるーい特徴
- **簡単すぎ**: QRコードでピッ！もう参加完了
- **適当でOK**: 深く考えずに好きなの選べばいいじゃん
- **誰でもウェルカム**: 動物アイコンがかわいいから許す
- **欠席してもOK**: CPU参加で存在感キープ！

## 🏢 プロジェクト概要

**オンラインドラフトアプリケーション**
- 「推しを選んで、かぶったら勝負！」がコンセプトのゆるーいWebアプリ
- 友達・家族・仲間とオンラインでワイワイドラフト会議
- 難しいこと考えずに、好きなもの選んで盛り上がれる

### 👥 ユーザーロール
- **参加者**: ドラフトに参加してアイテムを選択するユーザー
- **管理者**: ドラフトの作成・管理を行うユーザー

## 📦 機能一覧

### 1️⃣ グループ管理機能
#### 既存機能（そのまま維持）
- ✅ グループ名を入力してルーム作成
- ✅ グループIDで参加
- ✅ ローカルストレージに履歴保存

#### 新規追加
- 🆕 **QRコード共有**: URLとQRコード両方で招待できる

### 2️⃣ ユーザー管理機能
#### 既存機能（そのまま維持）
- ✅ 名前と動物アイコン（18種類）で登録
- ✅ Firebase匿名認証対応
- ✅ 複数デバイス対応（同じユーザーで複数端末OK）
- ✅ 既存ユーザー選択して再ログイン可能

### 3️⃣ ドラフト機能（コア機能）
#### 既存機能（そのまま維持）
- ✅ ラウンド制で進行
- ✅ アイテム選択＋コメント入力
- ✅ 重複時はランダムID勝負（スロット演出で盛り上げ）
- ✅ 過去ラウンドの編集可能
- ✅ 編集ログをチャットに表示

#### 新規追加
- 🆕 **事前リスト作成機能**
  - リストを事前に作成・保存
  - プライベート設定（認証ユーザーのみ閲覧可）
  - グループメンバーと共有可能
  - 急な欠席者をCPU参加させられる

### 4️⃣ リアルタイムチャット機能
#### 既存機能（そのまま維持）
- ✅ グループ内リアルタイムチャット
- ✅ 自動スクロール（新着メッセージで最下部へ）
- ✅ システムログ表示（編集ログなど）

### 5️⃣ UI/UX
#### 既存機能（そのまま維持）
- ✅ レスポンシブデザイン（PC・スマホ対応）
- ✅ ドラフトテーブル（全員の選択状況一覧）
- ✅ モーダル表示（結果発表、アイテム入力など）

#### 新規追加
- 🆕 **わかりやすいTOPページ**
  - 初見でも使い方がわかるデザイン
  - 「グループを作る」「グループに参加」が一目瞭然
  - 最近参加したグループへのクイックアクセス
- 🆕 **インタラクティブチュートリアル**
  - 初回利用時に自動表示
  - ステップバイステップで操作説明
  - いつでも見返せる「使い方」ボタン
- 🆕 **モバイルUI改善**
  - より見やすく、操作しやすく
  - タッチ操作の最適化

### 6️⃣ その他の機能
#### 既存機能（そのまま維持）
- ✅ 観戦モード（`/log/[id]`でチャットのみ閲覧）
- ✅ 4つのページ構成
  - ホーム（`/`）
  - ロビー（`/lobby/[id]`）（旧エントリー）
  - ドラフト（`/draft/[id]`）
  - ログ（`/log/[id]`）

## 📊 実装優先度

| 優先度 | 機能 | 理由 |
|--------|------|------|
| 🥇 高 | わかりやすいTOPページ | 最初の印象が大事 |
| 🥇 高 | QRコード共有 | 実装簡単＆便利 |
| 🥇 高 | モバイルUI改善 | ユーザビリティ向上 |
| 🥈 中 | チュートリアル | 初回ユーザーサポート |
| 🥈 中 | 事前リスト作成 | CPU参加に便利 |
| 🥉 低 | その他の改善 | 余裕があれば |

## 🎯 主要機能（詳細版）

### 1. **グループ管理機能**
- グループ作成: グループ名を入力して新しいドラフトルームを作成
- グループ参加: 作成されたグループIDを使って他のユーザーが参加可能
- 履歴管理: 過去に参加したグループの履歴をローカルストレージに保存

### 2. **ユーザー管理機能**
- 匿名認証: Firebase Authを使用した匿名認証
- ユーザー作成: 名前とアバター（18種類の動物アイコン）を選択して登録
- 既存ユーザー選択: 既に登録済みのユーザーとしてログイン可能
- 複数デバイス対応: 同じユーザーで複数デバイスからアクセス可能

### 3. **ドラフト機能（コア機能）**
- ラウンド制: 複数ラウンドで進行するドラフトシステム
- アイテム選択: 各ユーザーが順番にアイテム（例：競走馬名）を選択
- コメント機能: 選択時にコメントを追加可能
- 重複チェック: 同じラウンドで同じアイテムが選択された場合の処理
- ランダム抽選: 重複時は選択時に既に割り振られたランダムIDで勝者決定（スロットは演出）
- 編集機能: 過去のラウンドの選択を編集可能

### 4. **リアルタイムチャット機能**
- グループチャット: 参加者全員でリアルタイムチャット
- 自動スクロール: 新着メッセージで自動的に最下部へスクロール
- システムログ: 編集ログなどのシステムメッセージも表示

### 5. **UI/UX機能**
- レスポンシブデザイン: PC・スマホ両対応
- ドラフトテーブル: 全ユーザーの選択状況を一覧表示
- スロットアニメーション: 結果発表時のドキドキ感を演出（実際は既に決定済み）
- モーダル表示: 結果発表、アイテム入力などはモーダルで表示

## 🛠 技術面の変更

### バックエンド（変更なし）
- ✅ Firebase Firestore（リアルタイム同期）
- ✅ Firebase Auth（匿名認証）

### フロントエンド（モダン化）
- 🔄 Redux → **Jotai**（シンプルな状態管理）
- 🔄 Next.js 12 → **Next.js 15**
- 🔄 Chakra UI v2 → **Chakra UI v3**
- 🔄 JavaScript → **TypeScript 5**（型安全）

## 🎮 現在の実装状況

### ✅ 完了済み機能
- **TOPページ**: 完全なランディングページ
  - オンラインドラフト会議タイトル
  - ドラフト作成・参加の大きなCTAボタン
  - 使い方説明（3ステップ）
  - 自然で落ち着いた色合い
- **参加システム**: 完全な参加フロー
  - コード・URL・履歴から参加可能
  - エラーハンドリング・バリデーション
  - レスポンシブデザイン
- **ロビーシステム**: ユーザー設定フロー
  - 既存ユーザー選択・新規作成
  - 18種類動物アバター
  - ステップ分離UI
- **認証システム**: Firebase匿名認証
  - Jotai状態管理統合
  - テストページ完備

### 🔄 実装中
- 認証システム完成
- 他ページとの認証連携

### 📋 実装予定
- ドラフト機能（legacy参考で新実装）
- チャット機能（Firestore リアルタイム）
- 結果表示（新UI/UX）

## 🎉 まとめ
**「推しを選んで、かぶったら勝負！」**

深く考えない。好きなもの選ぶ。かぶったら笑う。
それだけで楽しいドラフトアプリ！🍺✨
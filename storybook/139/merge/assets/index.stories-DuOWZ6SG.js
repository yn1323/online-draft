import{e as G,j as e}from"./stack-BPGBxmP7.js";import{a as F,s as L,u as N}from"./useGroup-BRDEGd6P.js";import{r as f}from"./index-BXymfbzT.js";import{T as c}from"./text-CvVCgmJx.js";import{V as h}from"./v-stack-Dfms-mlT.js";import{B as b}from"./button-DOuB3_TC.js";import{C as _,a as C}from"./card-DlhQdIZJ.js";import"./jsx-runtime-Bw5QeaCk.js";import"./attr-C3Jtgmrz.js";import"./create-slot-recipe-context-BnxH4US7.js";const{withContext:O}=G({key:"badge"}),V=O("span"),W=()=>{const[t,o]=f.useState({user:null,loading:!0,error:null});f.useEffect(()=>F.onAuthStateChanged(r=>{o({user:r,loading:!1,error:null})},r=>{o({user:null,loading:!1,error:r})}),[]);const g=async()=>{try{return o(r=>({...r,loading:!0,error:null})),(await L(F)).user}catch(a){if(a instanceof Error){let n="予期しないエラーが発生しました";a.message.includes("permission-denied")?n="認証権限エラー - この操作は許可されていません":a.message.includes("unavailable")&&(n="接続エラー - インターネット接続を確認してください");const m=new Error(n);throw o(p=>({...p,loading:!1,error:m})),m}const r=new Error("認証処理中にエラーが発生しました");throw o(n=>({...n,loading:!1,error:r})),r}};return{user:t.user,loading:t.loading,error:t.error,signInAnonymous:g,isAuthenticated:!!t.user}},x=()=>{var j;const{user:t,loading:o,error:g,signInAnonymous:a,isAuthenticated:r}=W(),{createGroup:n,checkGroupExists:m}=N(),[p,y]=f.useState([]),i=s=>{y(l=>[...l,`${new Date().toLocaleTimeString()}: ${s}`])},k=async()=>{try{i("🔐 匿名認証テスト開始..."),await a(),i("✅ 匿名認証成功")}catch(s){i(`❌ 匿名認証失敗: ${s}`)}},z=async()=>{try{i("📊 Firestore書き込みテスト開始...");const s=await n("テストルーム");i(`✅ グループ作成成功: ${s}`);const l=await m(s);i(`✅ グループ存在確認: ${l?"存在":"不存在"}`)}catch(s){i(`❌ Firestore操作失敗: ${s}`)}},I=()=>{y([])};return o?e.jsx(_,{children:e.jsx(C,{children:e.jsx(c,{children:"Firebase接続中..."})})}):e.jsx(_,{children:e.jsx(C,{children:e.jsxs(h,{gap:4,align:"stretch",children:[e.jsx(c,{fontSize:"lg",fontWeight:"bold",children:"🧪 Firebase接続テスト"}),e.jsxs(c,{children:["認証状態:"," ",e.jsx(V,{colorScheme:r?"green":"red",children:r?`認証済み (${(j=t==null?void 0:t.uid)==null?void 0:j.slice(0,8)}...)`:"未認証"})]}),g&&e.jsxs(c,{color:"red.500",fontSize:"sm",children:["エラー: ",g.message]}),e.jsxs(h,{gap:2,children:[e.jsx(b,{bg:"blue.400",color:"white",onClick:k,disabled:r,_hover:{bg:"blue.500"},_active:{bg:"blue.600"},children:"匿名認証テスト"}),e.jsx(b,{bg:"green.400",color:"white",onClick:z,disabled:!r,_hover:{bg:"green.500"},_active:{bg:"green.600"},children:"Firestoreテスト"}),e.jsx(b,{bg:"gray.400",color:"white",onClick:I,size:"sm",_hover:{bg:"gray.500"},_active:{bg:"gray.600"},children:"結果クリア"})]}),p.length>0&&e.jsxs(h,{gap:1,align:"stretch",children:[e.jsx(c,{fontSize:"md",fontWeight:"bold",children:"テスト結果:"}),p.map((s,l)=>e.jsx(c,{fontSize:"sm",fontFamily:"mono",children:s},l))]})]})})})};try{x.displayName="FirebaseTest",x.__docgenInfo={description:"Firebase接続テスト用開発コンポーネント",displayName:"FirebaseTest",props:{}}}catch{}const Z={title:"Dev/FirebaseTest",component:x,parameters:{layout:"centered"}},u={},d={};var S,w,A,E,T;u.parameters={...u.parameters,docs:{...(S=u.parameters)==null?void 0:S.docs,source:{originalSource:"{}",...(A=(w=u.parameters)==null?void 0:w.docs)==null?void 0:A.source},description:{story:`デフォルト表示
Firebase接続テスト機能`,...(T=(E=u.parameters)==null?void 0:E.docs)==null?void 0:T.description}}};var v,D,B,R,$;d.parameters={...d.parameters,docs:{...(v=d.parameters)==null?void 0:v.docs,source:{originalSource:`{
  // NOTE: 実際にはloadingプロップを追加する際に対応
}`,...(B=(D=d.parameters)==null?void 0:D.docs)==null?void 0:B.source},description:{story:`ローディング状態
Firebase接続中の表示`,...($=(R=d.parameters)==null?void 0:R.docs)==null?void 0:$.description}}};const ee=["Default","Loading"];export{u as Default,d as Loading,ee as __namedExportsOrder,Z as default};

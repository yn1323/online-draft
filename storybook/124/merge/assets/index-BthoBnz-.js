import{j as p,L as h,M as y}from"./index-CXxrkVEp.js";function A(e){return new Proxy({},{get(t,a){return a==="style"?r=>e({style:r}).style:e}})}var b=()=>e=>Array.from(new Set(e)),i=(e,t=[])=>({parts:(...a)=>{if(k(t))return i(e,a);throw new Error("createAnatomy().parts(...) should only be called once. Did you mean to use .extendWith(...) ?")},extendWith:(...a)=>i(e,[...t,...a]),rename:a=>i(a,t),keys:()=>t,build:()=>[...new Set(t)].reduce((a,r)=>Object.assign(a,{[r]:{selector:[`&[data-scope="${s(e)}"][data-part="${s(r)}"]`,`& [data-scope="${s(e)}"][data-part="${s(r)}"]`].join(", "),attrs:{"data-scope":s(e),"data-part":s(r)}}}),{})}),s=e=>e.replace(/([A-Z])([A-Z])/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase(),k=e=>e.length===0,f=i("avatar").parts("root","image","fallback"),l=f.build(),m=e=>{var t;return((t=e.ids)==null?void 0:t.root)??`avatar:${e.id}`},u=e=>{var t;return((t=e.ids)==null?void 0:t.image)??`avatar:${e.id}:image`},E=e=>{var t;return((t=e.ids)==null?void 0:t.fallback)??`avatar:${e.id}:fallback`},I=e=>e.getById(m(e)),g=e=>e.getById(u(e));function L(e,t){const{state:a,send:r,prop:d,scope:n}=e,o=a.matches("loaded");return{loaded:o,setSrc(v){const c=g(n);c==null||c.setAttribute("src",v)},setLoaded(){r({type:"img.loaded",src:"api"})},setError(){r({type:"img.error",src:"api"})},getRootProps(){return t.element({...l.root.attrs,dir:d("dir"),id:m(n)})},getImageProps(){return t.img({...l.image.attrs,hidden:!o,dir:d("dir"),id:u(n),"data-state":o?"visible":"hidden",onLoad(){r({type:"img.loaded",src:"element"})},onError(){r({type:"img.error",src:"element"})}})},getFallbackProps(){return t.element({...l.fallback.attrs,dir:d("dir"),id:E(n),hidden:o,"data-state":o?"hidden":"visible"})}}}var C=p({initialState(){return"loading"},effects:["trackImageRemoval","trackSrcChange"],on:{"src.change":{target:"loading"},"img.unmount":{target:"error"}},states:{loading:{entry:["checkImageStatus"],on:{"img.loaded":{target:"loaded",actions:["invokeOnLoad"]},"img.error":{target:"error",actions:["invokeOnError"]}}},error:{on:{"img.loaded":{target:"loaded",actions:["invokeOnLoad"]}}},loaded:{on:{"img.error":{target:"error",actions:["invokeOnError"]}}}},implementations:{actions:{invokeOnLoad({prop:e}){var t;(t=e("onStatusChange"))==null||t({status:"loaded"})},invokeOnError({prop:e}){var t;(t=e("onStatusChange"))==null||t({status:"error"})},checkImageStatus({send:e,scope:t}){const a=g(t);if(!(a!=null&&a.complete))return;const r=S(a)?"img.loaded":"img.error";e({type:r,src:"ssr"})}},effects:{trackImageRemoval({send:e,scope:t}){const a=I(t);return y(a,{callback(r){Array.from(r[0].removedNodes).find(o=>o.nodeType===Node.ELEMENT_NODE&&o.matches("[data-scope=avatar][data-part=image]"))&&e({type:"img.unmount"})}})},trackSrcChange({send:e,scope:t}){const a=g(t);return h(a,{attributes:["src","srcset"],callback(){e({type:"src.change"})}})}}}});function S(e){return e.complete&&e.naturalWidth!==0&&e.naturalHeight!==0}b()(["dir","id","ids","onStatusChange","getRootNode"]);export{b as a,f as b,i as c,A as d,L as e,C as m};

import{p as Ce,c as xe,m as Ue,a as $e}from"./mockData-DISdYL5i.js";import{j as n,c as We,f as qe,m as He}from"./stack-B25eOQea.js";import{u as ze}from"./index-yHYUIvBd.js";import{r as p}from"./index-BXymfbzT.js";import{L as Ke,a as Xe}from"./index-BrT_qiXh.js";import{L as Ge}from"./index-Cki5ZDSJ.js";import{q as Je,o as Qe,w as K,c as we,a as Ye,d as X,s as G,b as I}from"./index.esm2017-mzQehXGw.js";import{d as Te}from"./firebase-DBrNdAmE.js";import{u as Ze}from"./useRealtimeUsers-n9Hs04w7.js";import{C as J}from"./index-levynJQQ.js";import{C as Q}from"./index-Da6JIO9m.js";import{C as Y}from"./index-RadsqkfI.js";import{u as et,E as Z}from"./index-CpSbkw6O.js";import{u as tt,I as ee}from"./index-D7_4nBc7.js";import{u as st,O as te}from"./index-CHy0t8T4.js";import{P as se}from"./index-CSzk8Hve.js";import{u as rt}from"./use-breakpoint-BiEj9wsk.js";import{V as $}from"./v-stack-DLbVHDKJ.js";import{B as C}from"./box-BDoFiJcT.js";import{T as j}from"./text-ddCD_fM-.js";import{H as re}from"./h-stack-Bm4oIVhc.js";import{C as Re}from"./container-DUbPfsQN.js";import{G as at}from"./grid-W1xKhCbE.js";import{c as ot}from"./create-slot-recipe-context-BILcAqFF.js";import{c as M,u as nt,a as it,b as ct,n as lt}from"./index-DQKawd5P.js";import{u as ut,s as Ie,R as Pe}from"./render-strategy-CvFi1cA2.js";import{c as dt,a as S,b as pt}from"./factory-CQjN0O8Q.js";import{c as ft}from"./index-BRNWFSEf.js";import{I as F,J as T,K as mt,E as gt,L as ht,H as vt,N as bt,o as yt,O as Ct,P as xt,Q as wt,r as P,R as Tt,S as Rt,T as It,w as Pt,U as Et,q as St}from"./index-D3iQu9n-.js";import{p as Ft,q as Vt}from"./index-BPRKcNEv.js";import{c as q}from"./index-CrjboX4Z.js";import{u as jt,P as At}from"./responsive-modal-Cx12ZJOs.js";import"./jsx-runtime-Bw5QeaCk.js";import"./index-C0w2AICy.js";import"./_interop_require_wildcard-BpaVepTj.js";import"./spinner-BaqUdWIg.js";import"./index-C9wqLcGi.js";import"./button-BzGfOniU.js";import"./attr-C3Jtgmrz.js";import"./index-Bxr0EmBi.js";import"./index-CWtFKQuP.js";import"./index-DGKHe-6Q.js";import"./image-context-B4PdNff0.js";import"./index-6PFvwfVV.js";import"./index-wmCFGDfF.js";import"./card-BfIoSqEc.js";import"./index-D3tWnGF_.js";import"./icon-button-CZw3PtnZ.js";import"./index-D_DKZCCl.js";function Ot(e,t){const[r,s]=p.useState(e);return p.useEffect(()=>{const o=setTimeout(()=>{s(e)},t);return()=>{clearTimeout(o)}},[e,t]),r}const[Ee,N]=dt({name:"TabsContext",hookName:"useTabsContext",providerName:"<TabsProvider />"}),Se=p.forwardRef((e,t)=>{const[r,s]=M()(e,["value"]),o=N(),a=ut(),i=jt({...a,present:Ot(o.value===e.value,0),immediate:!0}),u=F(o.getContentProps(r),i.getPresenceProps(),s);return n.jsx(At,{value:i,children:i.unmounted?null:n.jsx(S.div,{...u,ref:pt(i.ref,t)})})});Se.displayName="TabContent";const Fe=p.forwardRef((e,t)=>{const r=N(),s=F(r.getIndicatorProps(),e);return n.jsx(S.div,{...s,ref:t})});Fe.displayName="TabIndicator";const Ve=p.forwardRef((e,t)=>{const r=N(),s=F(r.getListProps(),e);return n.jsx(S.div,{...s,ref:t})});Ve.displayName="TabList";const je=p.forwardRef((e,t)=>{const[r,s]=M()(e,["disabled","value"]),o=N(),a=F(o.getTriggerProps(r),s);return n.jsx(S.button,{...a,ref:t})});je.displayName="TabTrigger";var _t=ft("tabs").parts("root","list","trigger","content","indicator"),A=_t.build(),Dt=e=>{var t;return((t=e.ids)==null?void 0:t.root)??`tabs:${e.id}`},_=e=>{var t;return((t=e.ids)==null?void 0:t.list)??`tabs:${e.id}:list`},W=(e,t)=>{var r;return((r=e.ids)==null?void 0:r.content)??`tabs:${e.id}:content-${t}`},R=(e,t)=>{var r;return((r=e.ids)==null?void 0:r.trigger)??`tabs:${e.id}:trigger-${t}`},Ae=e=>{var t;return((t=e.ids)==null?void 0:t.indicator)??`tabs:${e.id}:indicator`},kt=e=>e.getById(_(e)),Bt=(e,t)=>e.getById(W(e,t)),B=(e,t)=>e.getById(R(e,t)),ae=e=>e.getById(Ae(e)),D=e=>{const r=`[role=tab][data-ownedby='${CSS.escape(_(e))}']:not([disabled])`;return St(kt(e),r)},Lt=e=>Vt(D(e)),Mt=e=>Ft(D(e)),Nt=(e,t)=>It(D(e),R(e,t.value),t.loopFocus),Ut=(e,t)=>Rt(D(e),R(e,t.value),t.loopFocus),Oe=e=>({left:(e==null?void 0:e.offsetLeft)??0,top:(e==null?void 0:e.offsetTop)??0,width:(e==null?void 0:e.offsetWidth)??0,height:(e==null?void 0:e.offsetHeight)??0}),$t=(e,t)=>{const r=Et(D(e),R(e,t));return _e(Oe(r))},_e=e=>({width:`${e.width}px`,height:`${e.height}px`,left:`${e.left}px`,top:`${e.top}px`});function Wt(e,t){const{state:r,send:s,context:o,prop:a,scope:i}=e,u=a("translations"),f=r.matches("focused"),c=a("orientation")==="vertical",m=a("orientation")==="horizontal",g=a("composite");function w(l){return{selected:o.get("value")===l.value,focused:o.get("focusedValue")===l.value,disabled:!!l.disabled}}return{value:o.get("value"),focusedValue:o.get("focusedValue"),setValue(l){s({type:"SET_VALUE",value:l})},clearValue(){s({type:"CLEAR_VALUE"})},setIndicatorRect(l){const d=R(i,l);s({type:"SET_INDICATOR_RECT",id:d})},syncTabIndex(){s({type:"SYNC_TAB_INDEX"})},selectNext(l){s({type:"TAB_FOCUS",value:l,src:"selectNext"}),s({type:"ARROW_NEXT",src:"selectNext"})},selectPrev(l){s({type:"TAB_FOCUS",value:l,src:"selectPrev"}),s({type:"ARROW_PREV",src:"selectPrev"})},focus(){var d;const l=o.get("value");l&&((d=B(i,l))==null||d.focus())},getRootProps(){return t.element({...A.root.attrs,id:Dt(i),"data-orientation":a("orientation"),"data-focus":T(f),dir:a("dir")})},getListProps(){return t.element({...A.list.attrs,id:_(i),role:"tablist",dir:a("dir"),"data-focus":T(f),"aria-orientation":a("orientation"),"data-orientation":a("orientation"),"aria-label":u==null?void 0:u.listLabel,onKeyDown(l){if(l.defaultPrevented||!ht(l)||vt(l))return;const d={ArrowDown(){m||s({type:"ARROW_NEXT",key:"ArrowDown"})},ArrowUp(){m||s({type:"ARROW_PREV",key:"ArrowUp"})},ArrowLeft(){c||s({type:"ARROW_PREV",key:"ArrowLeft"})},ArrowRight(){c||s({type:"ARROW_NEXT",key:"ArrowRight"})},Home(){s({type:"HOME"})},End(){s({type:"END"})}};let y=bt(l,{dir:a("dir"),orientation:a("orientation")});const v=d[y];if(v){l.preventDefault(),v(l);return}}})},getTriggerState:w,getTriggerProps(l){const{value:d,disabled:y}=l,v=w(l);return t.button({...A.trigger.attrs,role:"tab",type:"button",disabled:y,dir:a("dir"),"data-orientation":a("orientation"),"data-disabled":T(y),"aria-disabled":y,"data-value":d,"aria-selected":v.selected,"data-selected":T(v.selected),"data-focus":T(v.focused),"aria-controls":v.selected?W(i,d):void 0,"data-ownedby":_(i),"data-ssr":T(o.get("ssr")),id:R(i,d),tabIndex:v.selected&&g?0:-1,onFocus(){s({type:"TAB_FOCUS",value:d})},onBlur(b){const x=b.relatedTarget;(x==null?void 0:x.getAttribute("role"))!=="tab"&&s({type:"TAB_BLUR"})},onClick(b){b.defaultPrevented||mt(b)||y||(gt()&&b.currentTarget.focus(),s({type:"TAB_CLICK",value:d}))}})},getContentProps(l){const{value:d}=l,y=o.get("value")===d;return t.element({...A.content.attrs,dir:a("dir"),id:W(i,d),tabIndex:g?0:-1,"aria-labelledby":R(i,d),role:"tabpanel","data-ownedby":_(i),"data-selected":T(y),"data-orientation":a("orientation"),hidden:!y})},getIndicatorProps(){const l=o.get("indicatorRect"),d=o.get("indicatorTransition");return t.element({id:Ae(i),...A.indicator.attrs,dir:a("dir"),"data-orientation":a("orientation"),style:{"--transition-property":"left, right, top, bottom, width, height","--left":l.left,"--top":l.top,"--width":l.width,"--height":l.height,position:"absolute",willChange:"var(--transition-property)",transitionProperty:"var(--transition-property)",transitionDuration:d?"var(--transition-duration, 150ms)":"0ms",transitionTimingFunction:"var(--transition-timing-function)",[m?"left":"top"]:m?"var(--left)":"var(--top)"}})}}}var{createMachine:qt}=yt(),Ht=qt({props({props:e}){return{dir:"ltr",orientation:"horizontal",activationMode:"automatic",loopFocus:!0,composite:!0,navigate(t){Pt(t.node)},defaultValue:null,...e}},initialState(){return"idle"},context({prop:e,bindable:t}){return{value:t(()=>({defaultValue:e("defaultValue"),value:e("value"),onChange(r){var s;(s=e("onValueChange"))==null||s({value:r})}})),focusedValue:t(()=>({defaultValue:e("value")||e("defaultValue"),sync:!0,onChange(r){var s;(s=e("onFocusChange"))==null||s({focusedValue:r})}})),ssr:t(()=>({defaultValue:!0})),indicatorTransition:t(()=>({defaultValue:!1})),indicatorRect:t(()=>({defaultValue:{left:"0px",top:"0px",width:"0px",height:"0px"}}))}},watch({context:e,prop:t,track:r,action:s}){r([()=>e.get("value")],()=>{s(["allowIndicatorTransition","syncIndicatorRect","syncTabIndex","navigateIfNeeded"])}),r([()=>t("dir"),()=>t("orientation")],()=>{s(["syncIndicatorRect"])})},on:{SET_VALUE:{actions:["setValue"]},CLEAR_VALUE:{actions:["clearValue"]},SET_INDICATOR_RECT:{actions:["setIndicatorRect"]},SYNC_TAB_INDEX:{actions:["syncTabIndex"]}},entry:["syncIndicatorRect","syncTabIndex","syncSsr"],exit:["cleanupObserver"],states:{idle:{on:{TAB_FOCUS:{target:"focused",actions:["setFocusedValue"]},TAB_CLICK:{target:"focused",actions:["setFocusedValue","setValue"]}}},focused:{on:{TAB_CLICK:{actions:["setFocusedValue","setValue"]},ARROW_PREV:[{guard:"selectOnFocus",actions:["focusPrevTab","selectFocusedTab"]},{actions:["focusPrevTab"]}],ARROW_NEXT:[{guard:"selectOnFocus",actions:["focusNextTab","selectFocusedTab"]},{actions:["focusNextTab"]}],HOME:[{guard:"selectOnFocus",actions:["focusFirstTab","selectFocusedTab"]},{actions:["focusFirstTab"]}],END:[{guard:"selectOnFocus",actions:["focusLastTab","selectFocusedTab"]},{actions:["focusLastTab"]}],TAB_FOCUS:{actions:["setFocusedValue"]},TAB_BLUR:{target:"idle",actions:["clearFocusedValue"]}}}},implementations:{guards:{selectOnFocus:({prop:e})=>e("activationMode")==="automatic"},actions:{selectFocusedTab({context:e,prop:t}){P(()=>{const r=e.get("focusedValue");if(!r)return;const o=t("deselectable")&&e.get("value")===r?null:r;e.set("value",o)})},setFocusedValue({context:e,event:t,flush:r}){t.value!=null&&r(()=>{e.set("focusedValue",t.value)})},clearFocusedValue({context:e}){e.set("focusedValue",null)},setValue({context:e,event:t,prop:r}){const s=r("deselectable")&&e.get("value")===e.get("focusedValue");e.set("value",s?null:t.value)},clearValue({context:e}){e.set("value",null)},focusFirstTab({scope:e}){P(()=>{var t;(t=Lt(e))==null||t.focus()})},focusLastTab({scope:e}){P(()=>{var t;(t=Mt(e))==null||t.focus()})},focusNextTab({context:e,prop:t,scope:r,event:s}){const o=s.value??e.get("focusedValue");if(!o)return;const a=Nt(r,{value:o,loopFocus:t("loopFocus")});P(()=>{t("composite")?a==null||a.focus():(a==null?void 0:a.dataset.value)!=null&&e.set("focusedValue",a.dataset.value)})},focusPrevTab({context:e,prop:t,scope:r,event:s}){const o=s.value??e.get("focusedValue");if(!o)return;const a=Ut(r,{value:o,loopFocus:t("loopFocus")});P(()=>{t("composite")?a==null||a.focus():(a==null?void 0:a.dataset.value)!=null&&e.set("focusedValue",a.dataset.value)})},syncTabIndex({context:e,scope:t}){P(()=>{const r=e.get("value");if(!r)return;const s=Bt(t,r);if(!s)return;Tt(s).length>0?s.removeAttribute("tabindex"):s.setAttribute("tabindex","0")})},cleanupObserver({refs:e}){const t=e.get("indicatorCleanup");t&&t()},allowIndicatorTransition({context:e}){e.set("indicatorTransition",!0)},setIndicatorRect({context:e,event:t,scope:r}){const s=t.id??e.get("value");if(!ae(r))return;if(!s){e.set("indicatorTransition",!1);return}B(r,s)&&(e.set("indicatorRect",$t(r,s)),wt(()=>{e.set("indicatorTransition",!1)}))},syncSsr({context:e}){e.set("ssr",!1)},syncIndicatorRect({context:e,refs:t,scope:r}){const s=t.get("indicatorCleanup");s&&s();const o=e.get("value");if(!o){e.set("indicatorTransition",!1);return}const a=B(r,o),i=ae(r);if(!a||!i)return;const u=xt([a],{measure(f){return Oe(f)},onEntry({rects:f}){const[c]=f;e.set("indicatorRect",_e(c))}});t.set("indicatorCleanup",u)},navigateIfNeeded({context:e,prop:t,scope:r}){var a;const s=e.get("value");if(!s)return;const o=B(r,s);Ct(o)&&((a=t("navigate"))==null||a({value:s,node:o,href:o.href}))}}}});q()(["activationMode","composite","deselectable","dir","getRootNode","id","ids","loopFocus","navigate","onFocusChange","onValueChange","orientation","translations","value","defaultValue"]);q()(["disabled","value"]);q()(["value"]);const zt=e=>{const t=p.useId(),{getRootNode:r}=nt(),{dir:s}=it(),o={id:t,dir:s,getRootNode:r,...e},a=ct(Ht,o);return Wt(a,lt)},De=p.forwardRef((e,t)=>{const[r,s]=Ie(e),[o,a]=M()(s,["activationMode","composite","defaultValue","deselectable","id","ids","loopFocus","navigate","onFocusChange","onValueChange","orientation","translations","value"]),i=zt(o),u=F(i.getRootProps(),a);return n.jsx(Ee,{value:i,children:n.jsx(Pe,{value:r,children:n.jsx(S.div,{...u,ref:t})})})});De.displayName="TabsRoot";const ke=p.forwardRef((e,t)=>{const[r,s]=Ie(e),[{value:o},a]=M()(s,["value"]),i=F(o.getRootProps(),a);return n.jsx(Ee,{value:o,children:n.jsx(Pe,{value:r,children:n.jsx(S.div,{...i,ref:t})})})});ke.displayName="TabsRootProvider";function oe(e){return He(e,t=>t==="auto"?"auto":`span ${t}/span ${t}`)}const ne=p.forwardRef(function(t,r){const{area:s,colSpan:o,colStart:a,colEnd:i,rowEnd:u,rowSpan:f,rowStart:c,...m}=t,g=We({gridArea:s,gridColumn:oe(o),gridRow:oe(f),gridColumnStart:a,gridColumnEnd:i,gridRowStart:c,gridRowEnd:u});return n.jsx(qe.div,{ref:r,css:g,...m})}),{withProvider:Be,withContext:k}=ot({key:"tabs"});Be(ke,"root",{forwardAsChild:!0});const Kt=Be(De,"root",{forwardAsChild:!0}),ie=k(je,"trigger",{forwardAsChild:!0}),ce=k(Se,"content",{forwardAsChild:!0});k("div","contentGroup");const Xt=k(Ve,"list",{forwardAsChild:!0});k(Fe,"indicator",{forwardAsChild:!0});const Gt=(e,t,r)=>{const[s,o]=p.useState([]),[a,i]=p.useState(!0),[u,f]=p.useState(null);return p.useEffect(()=>{if(!e){o([]),i(!1);return}const c=Je(we(Te,"app/onlinedraft/log"),K("groupId","==",e),K("deleteFlg","==",!1),Qe("date","asc"));return Ye(c,g=>{const w=g.docs.map(l=>{var V;const d=l.data(),v=(((V=d.date)==null?void 0:V.toDate())||new Date).toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"}),b=d.userId==="system"||!d.userId,x=(t==null?void 0:t[d.userId])||{name:b?"システム":"匿名ユーザー",avatar:b?"99":"1"};return{id:l.id,userName:x.name,avatar:x.avatar,content:d.message,timestamp:v,isSystem:b,isCurrentUser:!b&&d.userId===r}});o(w),i(!1),f(null)},g=>{console.error("チャットメッセージ監視エラー:",g),f(g),i(!1)})},[e,t,r]),{messages:s,loading:a,error:u}},Jt=()=>{const e=we(Te,"app/onlinedraft/log"),t=p.useCallback(async(s,o,a)=>{if(!s.trim())throw new Error("グループIDが必要です");if(!o.trim())throw new Error("ユーザーIDが必要です");if(!a.trim())throw new Error("メッセージを入力してください");if(a.length>200)throw new Error("メッセージは200文字以内で入力してください");const i={groupId:s.trim(),userId:o.trim(),message:a.trim(),deleteFlg:!1};try{const u=X(e);await G(u,{...i,createdAt:I(),date:I(),updatedAt:I()})}catch(u){throw u instanceof Error?new Error(`メッセージ送信に失敗しました: ${u.message}`):new Error("メッセージ送信中に予期しないエラーが発生しました")}},[e]),r=p.useCallback(async(s,o)=>{if(!s.trim())throw new Error("グループIDが必要です");if(!o.trim())throw new Error("メッセージを入力してください");const a={groupId:s.trim(),userId:"system",message:o.trim(),deleteFlg:!1};try{const i=X(e);await G(i,{...a,createdAt:I(),date:I(),updatedAt:I()})}catch(i){throw i instanceof Error?new Error(`システムメッセージ送信に失敗しました: ${i.message}`):new Error("システムメッセージ送信中に予期しないエラーが発生しました")}},[e]);return{sendMessage:t,sendSystemMessage:r,logCollection:e}},Qt=(e,t)=>{const[r,s]=p.useState(!1),[o,a]=p.useState(null),{sendMessage:i}=Jt();return{loading:r,error:o,sendMessage:async f=>{if(f.trim()){s(!0),a(null);try{await i(e,t,f)}catch(c){throw a(c instanceof Error?c.message:"メッセージ送信に失敗しました"),c}finally{s(!1)}}}}},Yt=()=>{const[e,t]=p.useState(!1),[r,s]=p.useState(null);return{loading:e,error:r,selectItem:async(i,u)=>{t(!0),s(null);try{console.log("アイテム選択:",{item:i,comment:u}),await new Promise(f=>setTimeout(f,1e3))}catch(f){throw s(f instanceof Error?f.message:"アイテム選択に失敗しました"),f}finally{t(!1)}},editPick:async i=>{t(!0),s(null);try{console.log("ピック編集:",i),await new Promise(u=>setTimeout(u,1e3))}catch(u){throw s(u instanceof Error?u.message:"ピック編集に失敗しました"),u}finally{t(!1)}}}},Zt=()=>{const[e,t]=p.useState(!1),[r,s]=p.useState(null);return{loading:e,error:r,executeOpenResult:async()=>{t(!0),s(null);try{console.log("開票処理実行"),await new Promise(i=>setTimeout(i,2e3))}catch(i){throw s(i instanceof Error?i.message:"開票処理に失敗しました"),i}finally{t(!1)}},checkParticipantStatus:async()=>{try{return console.log("参加者状況チェック"),{allCompleted:!1,pendingCount:2}}catch(i){throw s(i instanceof Error?i.message:"状況確認に失敗しました"),i}}}},L=({currentRound:e,participants:t,pastResults:r,realtimeChatMessages:s,groupId:o,userId:a})=>{const i=rt({base:!0,md:!1}),[u,f]=p.useState("draft"),c=tt(),m=et(),g=st(),{selectItem:w}=Yt(),{sendMessage:l}=Qt(o,a),{executeOpenResult:d,checkParticipantStatus:y}=Zt(),v=async()=>{try{await w(c.selectedItem,c.comment),c.close()}catch(h){console.error("アイテム選択エラー:",h)}},b=async()=>{if(m.editingPick)try{await w(m.editingPick.currentPick),m.close()}catch(h){console.error("編集保存エラー:",h)}},x=(h,U,Le,Me,Ne)=>{m.open({round:h,playerId:U,playerName:Le,currentPick:Me,category:Ne})},V=async()=>{try{(await y()).allCompleted?await d():g.open()}catch(h){console.error("開票処理エラー:",h)}},H=async()=>{try{await d(),g.close()}catch(h){console.error("開票実行エラー:",h)}},z=async h=>{try{await l(h)}catch(U){console.error("チャット送信エラー:",U)}};return i?n.jsxs($,{h:"100vh",gap:0,children:[n.jsx(C,{bg:"white",borderBottom:"1px",borderColor:"gray.200",p:4,w:"full",position:"sticky",top:0,zIndex:10,children:n.jsx(j,{fontSize:"lg",fontWeight:"bold",textAlign:"center",children:"オンラインドラフト会議"})}),n.jsxs(Kt,{value:u,onValueChange:h=>f(h.value),flex:1,display:"flex",flexDirection:"column",w:"full",overflow:"hidden",children:[n.jsxs(Xt,{bg:"gray.50",borderBottom:"2px solid",borderColor:"gray.200",flexShrink:0,children:[n.jsx(ie,{value:"draft",flex:1,py:3,px:4,_selected:{bg:"white",color:"blue.600",borderBottom:"2px solid",borderColor:"blue.500",fontWeight:"bold"},transition:"all 0.15s ease",children:n.jsxs(re,{gap:2,justify:"center",w:"full",children:[n.jsx(Ke,{size:18}),n.jsx(j,{fontSize:"sm",children:"取得リスト"})]})}),n.jsx(ie,{value:"chat",flex:1,py:3,px:4,_selected:{bg:"white",color:"blue.600",borderBottom:"2px solid",borderColor:"blue.500",fontWeight:"bold"},transition:"all 0.15s ease",children:n.jsxs(re,{gap:2,justify:"center",w:"full",children:[n.jsx(Xe,{size:18}),n.jsx(j,{fontSize:"sm",children:"チャット"})]})})]}),n.jsxs(C,{flex:1,overflow:"hidden",minH:0,children:[n.jsx(ce,{value:"draft",h:"full",overflow:"auto",children:n.jsxs($,{gap:3,p:3,children:[n.jsx(Y,{participants:t,currentRound:e,variant:"sp",currentUserId:a,onItemSelect:c.open,onOpenResult:V}),n.jsx(se,{pastResults:r,participants:t,variant:"sp",onEditClick:x})]})}),n.jsx(ce,{value:"chat",h:"full",overflow:"hidden",display:"flex",flexDirection:"column",children:n.jsx(C,{flex:1,overflow:"auto",p:3,children:n.jsx(Q,{messages:s})})})]})]}),u==="chat"&&n.jsx(C,{bg:"white",borderTop:"1px",borderColor:"gray.200",p:3,w:"full",position:"sticky",bottom:0,children:n.jsx(J,{onSendMessage:z})}),n.jsx(ee,{isOpen:c.isOpen,selectedItem:c.selectedItem,comment:c.comment,onSelectedItemChange:c.setSelectedItem,onCommentChange:c.setComment,onClose:c.close,onSelect:v}),n.jsx(Z,{isOpen:m.isOpen,editingPick:m.editingPick,onClose:m.close,onSave:b,onEditingPickUpdate:m.updatePick}),n.jsx(te,{isOpen:g.isOpen,onClose:g.close,onExecuteOpenResult:H})]}):n.jsxs(C,{bg:"gray.50",minH:"100vh",py:8,children:[n.jsxs(Re,{maxW:"container.xl",children:[n.jsx(C,{mb:6,children:n.jsx(j,{fontSize:"2xl",fontWeight:"bold",color:"gray.800",children:"オンラインドラフト会議"})}),n.jsxs(at,{templateColumns:"7fr 3fr",gap:6,h:"calc(100vh - 130px)",children:[n.jsx(ne,{h:"100%",children:n.jsxs($,{gap:4,h:"100%",w:"full",align:"stretch",children:[n.jsx(Y,{participants:t,currentRound:e,variant:"pc",currentUserId:a,onItemSelect:c.open,onOpenResult:V}),n.jsx(se,{pastResults:r,participants:t,variant:"pc",onEditClick:x})]})}),n.jsx(ne,{h:"100%",children:n.jsxs(C,{h:"100%",maxH:"calc(100vh - 130px)",bg:"white",boxShadow:"lg",p:4,borderRadius:"lg",display:"flex",flexDirection:"column",overflow:"hidden",children:[n.jsx(j,{fontSize:"lg",fontWeight:"bold",mb:4,flexShrink:0,children:"チャット"}),n.jsx(C,{flex:"1",overflow:"auto",mb:3,minH:0,children:n.jsx(Q,{messages:s})}),n.jsx(C,{flexShrink:0,children:n.jsx(J,{onSendMessage:z})})]})})]})]}),n.jsx(ee,{isOpen:c.isOpen,selectedItem:c.selectedItem,comment:c.comment,onSelectedItemChange:c.setSelectedItem,onCommentChange:c.setComment,onClose:c.close,onSelect:v}),n.jsx(Z,{isOpen:m.isOpen,editingPick:m.editingPick,onClose:m.close,onSave:b,onEditingPickUpdate:m.updatePick}),n.jsx(te,{isOpen:g.isOpen,onClose:g.close,onExecuteOpenResult:H})]})},le=({groupId:e})=>{const t=ze(),[r,s]=p.useState("");p.useEffect(()=>{const c=sessionStorage.getItem("onlinedraft_user_id");c?s(c):t.push(`/lobby/${e}`)},[e,t]);const{users:o,loading:a}=Ze(e),i=p.useMemo(()=>o.reduce((c,m)=>(c[m.userId]={name:m.userName,avatar:m.avatar},c),{}),[o]),{messages:u}=Gt(e,i,r);if(!r||a)return n.jsx(C,{bg:"gray.50",minH:"100vh",py:[4,8],children:n.jsx(Re,{maxW:"container.lg",children:n.jsx(Ge,{message:"ローディング中..."})})});const f=o.map(c=>({id:c.userId,name:c.userName,avatar:c.avatar,acquisitions:[],currentPick:"選択中..."}));return n.jsx(L,{currentRound:xe,participants:f,pastResults:Ce,realtimeChatMessages:u,groupId:e,userId:r})};try{L.displayName="DraftPageInner",L.__docgenInfo={description:`ドラフト実行画面Innerコンポーネント（Presenter）
UI描画と状態管理を担当、新しいhooks構造を使用`,displayName:"DraftPageInner",props:{currentRound:{defaultValue:null,description:"",name:"currentRound",required:!0,type:{name:"number"}},participants:{defaultValue:null,description:"",name:"participants",required:!0,type:{name:"ParticipantType[]"}},pastResults:{defaultValue:null,description:"",name:"pastResults",required:!0,type:{name:"DraftRoundType[]"}},realtimeChatMessages:{defaultValue:null,description:"",name:"realtimeChatMessages",required:!0,type:{name:"ChatMessageUIType[]"}},groupId:{defaultValue:null,description:"",name:"groupId",required:!0,type:{name:"string"}},userId:{defaultValue:null,description:"",name:"userId",required:!0,type:{name:"string"}}}}}catch{}try{le.displayName="DraftPage",le.__docgenInfo={description:`ドラフト実行画面コンポーネント（Container）
モックデータの提供のみを担当`,displayName:"DraftPage",props:{groupId:{defaultValue:null,description:"",name:"groupId",required:!0,type:{name:"string"}}}}}catch{}const Gs={title:"features/draft/DraftPage",component:L,parameters:{layout:"fullscreen"}},E={args:{currentRound:xe,participants:$e,pastResults:Ce,realtimeChatMessages:Ue,groupId:"test-group-id",userId:"test-user-id"}},O={args:{...E.args},parameters:{viewport:{defaultViewport:"mobile1"}}};var ue,de,pe,fe,me;E.parameters={...E.parameters,docs:{...(ue=E.parameters)==null?void 0:ue.docs,source:{originalSource:`{
  args: {
    currentRound,
    participants: mockParticipants,
    pastResults: pastDraftResults,
    realtimeChatMessages: mockChatMessages,
    groupId: 'test-group-id',
    userId: 'test-user-id'
  }
}`,...(pe=(de=E.parameters)==null?void 0:de.docs)==null?void 0:pe.source},description:{story:`デフォルトのドラフトページ表示
新しいhooks構造を使用した純粋なUIテスト`,...(me=(fe=E.parameters)==null?void 0:fe.docs)==null?void 0:me.description}}};var ge,he,ve,be,ye;O.parameters={...O.parameters,docs:{...(ge=O.parameters)==null?void 0:ge.docs,source:{originalSource:`{
  args: {
    ...Default.args
  },
  parameters: {
    viewport: {
      defaultViewport: 'mobile1'
    }
  }
}`,...(ve=(he=O.parameters)==null?void 0:he.docs)==null?void 0:ve.source},description:{story:`SP表示の強制確認用
ビューポートを小さく設定してSP版レイアウトを確認`,...(ye=(be=O.parameters)==null?void 0:be.docs)==null?void 0:ye.description}}};const Js=["Default","SPLayout"];export{E as Default,O as SPLayout,Js as __namedExportsOrder,Gs as default};

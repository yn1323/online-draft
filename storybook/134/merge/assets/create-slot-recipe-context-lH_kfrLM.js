import{c as X}from"./factory-B-x4ZR3W.js";import{a1 as te,a2 as F,a3 as K}from"./index-5qRv5KYD.js";import{F as re,I as ne,J as se,G as A,w as B,K as oe,H as ce}from"./index-DoZAzkdv.js";import{r as c}from"./index-BXymfbzT.js";import{r as ue}from"./index-DGKHe-6Q.js";import{a as ae}from"./index-CrjboX4Z.js";import{g as ie,h as U,f as G,j as T,b as H,m as W,E as fe}from"./create-recipe-context-LbQq3bM7.js";const[Pe,Ee]=X({name:"EnvironmentContext",hookName:"useEnvironmentContext",providerName:"<EnvironmentProvider />",strict:!1,defaultValue:{getRootNode:()=>document,getDocument:()=>document,getWindow:()=>window}}),[we,Me]=X({name:"LocaleContext",hookName:"useLocaleContext",providerName:"<LocaleProvider />",strict:!1,defaultValue:{dir:"ltr",locale:"en-US"}}),be=()=>(e,o)=>o.reduce((u,s)=>{const[l,x]=u,S=s;return x[S]!==void 0&&(l[S]=x[S]),delete x[S],[l,x]},[{},{...e}]);var Y=ue(),Z=typeof globalThis.document<"u"?c.useLayoutEffect:c.useEffect;function _(e){const o=e().value??e().defaultValue,u=e().isEqual??Object.is,[s]=c.useState(o),[l,x]=c.useState(s),S=e().value!==void 0,C=c.useRef(l);C.current=S?e().value:l;const h=c.useRef(C.current);Z(()=>{h.current=C.current},[l,e().value]);const w=y=>{var f,m;const v=h.current,R=A(y)?y(v):y;e().debug&&console.log(`[bindable > ${e().debug}] setValue`,{next:R,prev:v}),S||x(R),u(R,v)||(m=(f=e()).onChange)==null||m.call(f,R,v)};function L(){return S?e().value:l}return{initial:s,ref:C,get:L,set(y){(e().sync?Y.flushSync:se)(()=>w(y))},invoke(y,v){var R,f;(f=(R=e()).onChange)==null||f.call(R,y,v)},hash(y){var v,R;return((R=(v=e()).hash)==null?void 0:R.call(v,y))??String(y)}}}_.cleanup=e=>{c.useEffect(()=>e,[])};_.ref=e=>{const o=c.useRef(e);return{get:()=>o.current,set:u=>{o.current=u}}};function le(e){const o=c.useRef(e);return{get(u){return o.current[u]},set(u,s){o.current[u]=s}}}var de=(e,o)=>{const u=c.useRef(!1),s=c.useRef(!1);c.useEffect(()=>{if(u.current&&s.current)return o();s.current=!0},[...(e??[]).map(l=>typeof l=="function"?l():l)]),c.useEffect(()=>(u.current=!0,()=>{u.current=!1}),[])};function je(e,o={}){var q,J,z,O;const u=c.useMemo(()=>{const{id:r,ids:t,getRootNode:n}=o;return te({id:r,ids:t,getRootNode:n})},[o]),s=(...r)=>{e.debug&&console.log(...r)},l=((q=e.props)==null?void 0:q.call(e,{props:re(o),scope:u}))??o,x=pe(l),S=(J=e.context)==null?void 0:J.call(e,{prop:x,bindable:_,scope:u,flush:Q,getContext(){return h},getComputed(){return b},getRefs(){return m}}),C=ee(S),h={get(r){var t;return(t=C.current)==null?void 0:t[r].ref.current},set(r,t){var n;(n=C.current)==null||n[r].set(t)},initial(r){var t;return(t=C.current)==null?void 0:t[r].initial},hash(r){var n,a;const t=(n=C.current)==null?void 0:n[r].get();return(a=C.current)==null?void 0:a[r].hash(t)}},w=c.useRef(new Map),L=c.useRef(null),y=c.useRef(null),v=c.useRef({type:""}),R=()=>({...v.current,current(){return v.current},previous(){return y.current}}),f=()=>({...p,matches(...r){return r.includes(p.ref.current)},hasTag(r){var t,n;return!!((n=(t=e.states[p.ref.current])==null?void 0:t.tags)!=null&&n.includes(r))}}),m=le(((z=e.refs)==null?void 0:z.call(e,{prop:x,context:h}))??{}),i=()=>({state:f(),context:h,event:R(),prop:x,send:I,action:d,guard:P,track:de,refs:m,computed:b,flush:Q,scope:u,choose:k}),d=r=>{const t=A(r)?r(i()):r;if(!t)return;const n=t.map(a=>{var N,j;const g=(j=(N=e.implementations)==null?void 0:N.actions)==null?void 0:j[a];return g||B(`[zag-js] No implementation found for action "${JSON.stringify(a)}"`),g});for(const a of n)a==null||a(i())},P=r=>{var t,n;return A(r)?r(i()):(n=(t=e.implementations)==null?void 0:t.guards)==null?void 0:n[r](i())},E=r=>{const t=A(r)?r(i()):r;if(!t)return;const n=t.map(g=>{var j,M;const N=(M=(j=e.implementations)==null?void 0:j.effects)==null?void 0:M[g];return N||B(`[zag-js] No implementation found for effect "${JSON.stringify(g)}"`),N}),a=[];for(const g of n){const N=g==null?void 0:g(i());N&&a.push(N)}return()=>a.forEach(g=>g==null?void 0:g())},k=r=>oe(r).find(t=>{let n=!t.guard;return ce(t.guard)?n=!!P(t.guard):A(t.guard)&&(n=t.guard(i())),n}),b=r=>{ne(e.computed,()=>"[zag-js] No computed object found on machine");const t=e.computed[r];return t({context:h,event:R(),prop:x,refs:m,scope:u,computed:b})},p=_(()=>({defaultValue:e.initialState({prop:x}),onChange(r,t){var a,g,N,j;if(t){const M=w.current.get(t);M==null||M(),w.current.delete(t)}t&&d((a=e.states[t])==null?void 0:a.exit),d((g=L.current)==null?void 0:g.actions);const n=E((N=e.states[r])==null?void 0:N.effects);if(n&&w.current.set(r,n),t===K){d(e.entry);const M=E(e.effects);M&&w.current.set(K,M)}d((j=e.states[r])==null?void 0:j.entry)}})),V=c.useRef(void 0),$=c.useRef(F.NotStarted);Z(()=>{queueMicrotask(()=>{const n=$.current===F.Started;$.current=F.Started,s(n?"rehydrating...":"initializing...");const a=V.current??p.initial;p.invoke(a,n?p.get():K)});const r=w.current,t=p.ref.current;return()=>{s("unmounting..."),V.current=t,$.current=F.Stopped,r.forEach(n=>n==null?void 0:n()),w.current=new Map,L.current=null,queueMicrotask(()=>{d(e.exit)})}},[]);const D=()=>"ref"in p?p.ref.current:p.get(),I=r=>{queueMicrotask(()=>{var j,M;if($.current!==F.Started)return;y.current=v.current,v.current=r,s("send",r);let t=D();const n=((j=e.states[t].on)==null?void 0:j[r.type])??((M=e.on)==null?void 0:M[r.type]),a=k(n);if(!a)return;L.current=a;const g=a.target??t;s("transition",a);const N=g!==t;N?Y.flushSync(()=>p.set(g)):a.reenter&&!N?p.invoke(t,t):d(a.actions??[])})};return(O=e.watch)==null||O.call(e,i()),{state:f(),send:I,context:h,prop:x,scope:u,refs:m,computed:b,event:R(),getStatus:()=>$.current}}function ee(e){const o=c.useRef(e);return o.current=e,o}function pe(e){const o=ee(e);return function(s){return o.current[s]}}function Q(e){queueMicrotask(()=>{Y.flushSync(()=>e())})}var he=ae(e=>e);function me(e){const{key:o,recipe:u}=e,s=ie();return c.useMemo(()=>{const l=u||(o!=null?s.getSlotRecipe(o):{});return s.sva(structuredClone(l))},[o,u,s])}const ge=e=>e.charAt(0).toUpperCase()+e.slice(1),ke=e=>{const{key:o,recipe:u}=e,s=ge(o||u.className||"Component"),[l,x]=U({name:`${s}StylesContext`,errorMessage:`use${s}Styles returned is 'undefined'. Seems you forgot to wrap the components in "<${s}.Root />" `}),[S,C]=U({name:`${s}ClassNameContext`,errorMessage:`use${s}ClassNames returned is 'undefined'. Seems you forgot to wrap the components in "<${s}.Root />" `,strict:!1}),[h,w]=U({strict:!1,name:`${s}PropsContext`,providerName:`${s}PropsContext`,defaultValue:{}});function L(f){const{unstyled:m,...i}=f,d=me({key:o,recipe:i.recipe||u}),[P,E]=c.useMemo(()=>d.splitVariantProps(i),[i,d]);return{styles:c.useMemo(()=>m?fe:d(P),[m,P,d]),classNames:d.classNameMap,props:E}}function y(f,m={}){const{defaultProps:i}=m,d=P=>{const E=w(),k=c.useMemo(()=>W(i,E,P),[E,P]),{styles:b,classNames:p,props:V}=L(k);return T.jsx(l,{value:b,children:T.jsx(S,{value:p,children:T.jsx(f,{...V})})})};return d.displayName=f.displayName||f.name,d}return{StylesProvider:l,ClassNamesProvider:S,PropsProvider:h,usePropsContext:w,useRecipeResult:L,withProvider:(f,m,i)=>{const{defaultProps:d,...P}=i??{},E=G(f,{},P),k=c.forwardRef((b,p)=>{var O;const V=w(),$=c.useMemo(()=>W(d??{},V,b),[V,b]),{styles:D,props:I,classNames:q}=L($),J=q[m],z=T.jsx(l,{value:D,children:T.jsx(S,{value:q,children:T.jsx(E,{ref:p,...I,css:[D[m],$.css],className:H($.className,J)})})});return((O=i==null?void 0:i.wrapElement)==null?void 0:O.call(i,z,$))??z});return k.displayName=f.displayName||f.name,k},withContext:(f,m,i)=>{const d=G(f,{},i),P=c.forwardRef((E,k)=>{const b=x(),p=C(),V=p==null?void 0:p[m];return T.jsx(d,{...E,css:[m?b[m]:void 0,E.css],ref:k,className:H(E.className,V)})});return P.displayName=f.displayName||f.name,P},withRootProvider:y,useStyles:x,useClassNames:C}};export{Me as a,je as b,ke as c,be as d,he as n,Y as r,Ee as u};

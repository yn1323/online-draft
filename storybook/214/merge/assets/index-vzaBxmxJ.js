import{j as o,f as uo}from"./stack-C7hvTRfV.js";import{A as F}from"./index-BacWYqUV.js";import{C as k}from"./index-CYsJy3kW.js";import{g as O,e as H,d as mo,f as po,h as fo,u as U,s as xo,i as q}from"./states-Bd1A8IJM.js";import{u as go}from"./toaster-fCX_dEN1.js";import{r as h}from"./index-BXymfbzT.js";import{B as C}from"./box-DfzLPJuh.js";import{T as g}from"./text-CD52-QEU.js";import{G as _}from"./grid-BguLyDGn.js";import{H as W}from"./h-stack-BRlU4uQg.js";import{V as A}from"./v-stack-3HiezQxF.js";import{u as P,a as T,b as G}from"./react-BSHoCbAh.js";import{c as ho}from"./create-slot-recipe-context-Ct6br2V7.js";import{c as S,a as L,u as M,b as J,n as K}from"./index-PsSrZQde.js";import{u as Co,s as Q,R as X}from"./render-strategy-F9cfH0Wk.js";import{c as N,a as I}from"./factory-hxkYGFqN.js";import{m as bo,c as vo,d as jo,e as yo}from"./index-R6MWo6e9.js";import{I as j}from"./index-CzEkc76M.js";const[Y,z]=N({name:"AccordionContext",hookName:"useAccordionContext",providerName:"<AccordionProvider />"}),[Ao,re]=N({name:"AccordionItemContext",hookName:"useAccordionItemContext",providerName:"<AccordionItemProvider />"}),Po=e=>S()(e,["defaultOpen","disabled","id","ids","lazyMount","onExitComplete","onOpenChange","open","unmountOnExit"]),Io=(e={})=>{const{lazyMount:s,unmountOnExit:t,...i}=e,c=h.useId(),n=h.useRef(!1),{dir:p}=L(),{getRootNode:x}=M(),v={id:c,dir:p,getRootNode:x,...i},f=J(bo,v),m=vo(f,K);m.visible&&(n.current=!0);const b=!m.visible&&!n.current&&s||t&&!m.visible&&n.current;return{...m,isUnmounted:b}},[So,Z]=N({name:"CollapsibleContext",hookName:"useCollapsibleContext",providerName:"<CollapsibleProvider />"}),oo=h.forwardRef((e,s)=>{const[t,i]=Po(e),c=Io(t),n=j(c.getRootProps(),i);return o.jsx(So,{value:c,children:o.jsx(I.div,{...n,ref:s})})});oo.displayName="CollapsibleRoot";const[wo,D]=N({name:"AccordionItemPropsContext",hookName:"useAccordionItemPropsContext",providerName:"<AccordionItemPropsProvider />"}),eo=h.forwardRef((e,s)=>{const[t,i]=S()(e,["value","disabled"]),c=z(),n=Co(),p=j(c.getItemProps(t),i),x=c.getItemState(t),v=c.getItemContentProps(t);return o.jsx(wo,{value:t,children:o.jsx(Ao,{value:x,children:o.jsx(oo,{ref:s,open:x.expanded,ids:{content:v.id},...n,...p})})})});eo.displayName="AccordionItem";const ro=h.forwardRef((e,s)=>{const t=Z();if(t.isUnmounted)return null;const i=j(t.getContentProps(),e);return o.jsx(I.div,{...i,ref:s})});ro.displayName="CollapsibleContent";const Ro=S(),to=h.forwardRef((e,s)=>{const t=z(),i=D(),c=t.getItemContentProps(i),[,n]=Ro(c,["hidden","data-state"]),p=j(n,e);return o.jsx(ro,{ref:s,...p})});to.displayName="AccordionItemContent";const no=h.forwardRef((e,s)=>{const t=z(),i=D(),c=j(t.getItemIndicatorProps(i),e);return o.jsx(I.div,{...c,ref:s})});no.displayName="AccordionItemIndicator";const so=h.forwardRef((e,s)=>{const t=z(),i=D(),c=Z(),n=t.getItemTriggerProps(i),p=j({...n,"aria-controls":c.isUnmounted?void 0:n["aria-controls"]},e);return o.jsx(I.button,{...p,ref:s})});so.displayName="AccordionItemTrigger";const No=e=>{const s=h.useId(),{getRootNode:t}=M(),{dir:i}=L(),c={id:s,dir:i,getRootNode:t,...e},n=J(yo,c);return jo(n,K)},io=h.forwardRef((e,s)=>{const[t,i]=Q(e),[c,n]=S()(i,["collapsible","defaultValue","disabled","id","ids","multiple","onFocusChange","onValueChange","orientation","value"]),p=No(c),x=j(p.getRootProps(),n);return o.jsx(Y,{value:p,children:o.jsx(X,{value:t,children:o.jsx(I.div,{...x,ref:s})})})});io.displayName="AccordionRoot";const co=h.forwardRef((e,s)=>{const[t,i]=Q(e),[{value:c},n]=S()(i,["value"]),p=j(c.getRootProps(),n);return o.jsx(Y,{value:c,children:o.jsx(X,{value:t,children:o.jsx(I.div,{...p,ref:s})})})});co.displayName="AccordionRootProvider";const zo=e=>o.jsx(uo.svg,{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:o.jsx("path",{d:"m6 9 6 6 6-6"})}),{withProvider:lo,withContext:w}=ho({key:"accordion"});lo(co,"root",{forwardAsChild:!0});const $o=lo(io,"root",{forwardAsChild:!0}),Eo=w(eo,"item",{forwardAsChild:!0}),Wo=w(to,"itemContent",{forwardAsChild:!0});w("div","itemBody");const Do=w(so,"itemTrigger",{forwardAsChild:!0}),Fo=w(no,"itemIndicator",{forwardAsChild:!0,defaultProps:{children:o.jsx(zo,{})}}),ko=G(e=>{const s=e(xo),t=e(U),{round:i}=e(O),c=e(H),n=e(q),x=s.filter(f=>f.round<i).reduce((f,m)=>(f[m.round]||(f[m.round]=[]),f[m.round].push(m),f),{}),v=(f,m)=>{if((n==null?void 0:n.userId)===f&&(n==null?void 0:n.round)===m)return"nextEditTarget";const b=c.find(a=>a.round===m);if(b){const a=b.conflictUsers.find(l=>l.userId===f);if(a)return a.isWinner?"winner":"loser"}return"none"};return Object.entries(x).map(([f,m])=>{const b=Number(f),a=t.map((l,d)=>{const r=m.find(u=>u.userId===l.id);return{order:d+1,userId:l.id,userName:l.name,avatar:l.avatar,item:(r==null?void 0:r.item)||"",comment:(r==null?void 0:r.comment)||"",conflictStatus:v(l.id,b)}});return{round:b,picks:a}}).sort((f,m)=>f.round-m.round)}),_o=G(e=>e(U).map(t=>({id:t.id,name:t.name,avatar:t.avatar,acquisitions:[]}))),V=(e,s)=>{switch(e){case"nextEditTarget":return{bg:"red.100",borderColor:"red.400",borderWidth:"2px",borderStyle:"solid",_hover:{bg:"red.150",borderColor:"red.500",transition:"all 0.15s ease"}};case"loser":return{bg:"orange.50",borderColor:"orange.300",borderWidth:"1px",borderStyle:"dashed",cursor:"not-allowed",opacity:.7,_hover:{bg:"orange.50"}};case"winner":case"none":return{borderColor:s?"gray.200":"gray.300",borderWidth:"1px",borderStyle:s?"solid":"dashed",_hover:{bg:"gray.50",borderColor:"gray.300",transition:"all 0.15s ease"}}}},B=({variant:e="sp",onEditClick:s})=>{const t=P(ko),i=P(_o),{round:c}=P(O),n=P(H),p=P(mo),x=P(q),v=T(po),f=T(fo),{errorToast:m}=go();h.useEffect(()=>{n.length>0&&!p.isActive?v():n.length===0&&p.isActive&&f()},[n.length,p.isActive,v,f]);const b=(a,l)=>{if(p.isActive&&x)if(x.userId===a&&x.round===l)s({userId:a,round:l});else{const d=n.find(u=>u.round===l&&u.conflictUsers.some(y=>y.userId===a&&!y.isWinner)),r=i.find(u=>u.id===x.userId);m(d?`このカードは重複指名で負けたため編集が必要です。まず${(r==null?void 0:r.name)||"対象ユーザー"}のRound ${x.round}から順番に編集してください。`:`重複指名解決中です。まず${(r==null?void 0:r.name)||"対象ユーザー"}のRound ${x.round}を編集してください。`)}else s({userId:a,round:l})};if(e==="pc"){const a={p:2,bg:"gray.100",borderRadius:"md",fontSize:"xs",fontWeight:"bold",textAlign:"center",color:"gray.700",display:"flex",alignItems:"center",justifyContent:"center",minH:"40px"},l={p:2,bg:"white",border:"1px solid",borderColor:"gray.200",borderRadius:"md",fontSize:"xs",minH:"40px",display:"flex",alignItems:"center"};return c===1?o.jsx(C,{flex:1,w:"full",children:o.jsx(k,{variant:"elevated",size:"md",children:o.jsxs(C,{h:"full",display:"flex",flexDirection:"column",children:[o.jsx(g,{fontSize:"md",fontWeight:"bold",mb:3,children:"過去のドラフト結果"}),o.jsx(C,{flex:1,display:"flex",alignItems:"center",justifyContent:"center",py:8,children:o.jsxs(g,{fontSize:"sm",color:"gray.500",textAlign:"center",children:["まだ開票が始まっていません",o.jsx("br",{}),"最初のRoundの抽選をお待ちください"]})})]})})}):o.jsx(C,{flex:1,w:"full",pb:2,children:o.jsx(k,{variant:"elevated",size:"md",children:o.jsxs(C,{h:"full",display:"flex",flexDirection:"column",children:[o.jsx(g,{fontSize:"md",fontWeight:"bold",mb:3,children:"ドラフト結果"}),o.jsxs(_,{templateColumns:`60px ${"minmax(120px, 1fr) ".repeat(i.length)}`,gap:2,mb:2,children:[o.jsx(C,{...a,children:"Round"}),i.map(d=>o.jsx(C,{...a,children:o.jsxs(W,{gap:1,justify:"center",children:[o.jsx(F,{avatarNumber:d.avatar,name:d.name,size:"xs"}),o.jsx(g,{children:d.name})]})},d.id))]}),o.jsx(C,{flex:"1",overflow:"auto",children:o.jsx(A,{gap:1,align:"stretch",children:t.sort((d,r)=>d.round-r.round).map(d=>o.jsxs(_,{templateColumns:`60px ${"minmax(120px, 1fr) ".repeat(i.length)}`,gap:2,children:[o.jsx(C,{...l,fontSize:"sm",fontWeight:"bold",textAlign:"center",color:"gray.800",justifyContent:"center",children:d.round}),i.map(r=>{const u=d.picks.find(ao=>ao.userId===r.id),y=!!(u!=null&&u.item),R=(u==null?void 0:u.conflictStatus)||"none",$=V(R,y),E=R!=="loser";return o.jsx(C,{...l,...$,cursor:E?"pointer":"not-allowed",onClick:()=>{b(r.id,d.round)},children:u!=null&&u.item?o.jsxs(A,{gap:0,align:"start",w:"full",children:[o.jsx(g,{fontWeight:"medium",color:"gray.800",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",w:"full",children:u.item}),o.jsx(g,{color:"gray.500",fontSize:"2xs",py:u.comment!==""?0:2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",w:"full",children:u.comment!==""?`(${u.comment})`:" "})]}):o.jsx(g,{color:"gray.400",fontSize:"2xs",children:"+ 追加"})},r.id)})]},d.round))})})]})})})}return c===1?o.jsxs(A,{gap:2,w:"full",children:[o.jsx(g,{fontSize:"md",fontWeight:"bold",color:"gray.800",alignSelf:"start",children:"ドラフト結果"}),o.jsx(C,{w:"full",py:12,display:"flex",alignItems:"center",justifyContent:"center",bg:"gray.50",borderRadius:"lg",border:"1px solid",borderColor:"gray.200",children:o.jsxs(g,{fontSize:"sm",color:"gray.500",textAlign:"center",children:["まだ開票が始まっていません",o.jsx("br",{}),"最初のRoundの抽選を開始してください"]})})]}):o.jsxs(A,{gap:2,w:"full",children:[o.jsx(g,{fontSize:"md",fontWeight:"bold",color:"gray.800",alignSelf:"start",children:"ドラフト結果"}),o.jsx($o,{defaultValue:[],multiple:!0,w:"full",variant:"enclosed",children:t.sort((a,l)=>a.round-l.round).map(a=>{const l=n.some(d=>d.round===a.round);return o.jsxs(Eo,{value:`round-${a.round}`,children:[o.jsx(Do,{bg:l?"red.50":void 0,borderColor:l?"red.200":void 0,_hover:{bg:l?"red.100":"gray.50"},children:o.jsxs(W,{justify:"space-between",w:"full",cursor:"pointer",children:[o.jsxs(g,{fontSize:"sm",fontWeight:"bold",color:l?"red.700":"gray.700",children:["Round ",a.round,l&&" 🔥"]}),o.jsx(Fo,{color:l?"red.500":void 0})]})}),o.jsx(Wo,{children:o.jsx(A,{gap:1,w:"full",py:2,children:i.map(d=>{const r=a.picks.find(E=>E.userId===d.id),u=!!(r!=null&&r.item),y=(r==null?void 0:r.conflictStatus)||"none",R=V(y,u),$=y!=="loser";return o.jsxs(W,{w:"full",p:1.5,...R,borderRadius:"md",cursor:$?"pointer":"not-allowed",onClick:()=>{b(d.id,a.round)},children:[o.jsx(F,{avatarNumber:d.avatar,name:d.name,size:"xs"}),o.jsxs(A,{align:"start",gap:0,flex:1,children:[o.jsx(g,{fontSize:"sm",fontWeight:"medium",children:d.name}),r!=null&&r.item?o.jsxs(o.Fragment,{children:[o.jsx(g,{fontSize:"sm",color:"gray.600",children:r.item}),o.jsx(g,{fontSize:"xs",color:"gray.600",py:r.comment!==""?0:2,children:r.comment!==""?`(${r.comment})`:""})]}):o.jsx(g,{fontSize:"xs",color:"gray.400",py:2,children:"+ 追加"})]})]},d.id)})})})]},a.round)})})]})};try{B.displayName="PastDraftResults",B.__docgenInfo={description:`過去のドラフト結果表示の共通コンポーネント
PC版: テーブル形式表示
SP版: アコーディオン形式表示`,displayName:"PastDraftResults",props:{variant:{defaultValue:{value:"sp"},description:"",name:"variant",required:!1,type:{name:"enum",value:[{value:'"pc"'},{value:'"sp"'}]}},onEditClick:{defaultValue:null,description:"",name:"onEditClick",required:!0,type:{name:"({ userId, round }: { userId?: string | undefined; round?: number | undefined; }) => void"}}}}}catch{}export{B as P};

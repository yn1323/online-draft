import{j as l}from"./create-recipe-context-DNTG5mYw.js";import{r as w}from"./index-BXymfbzT.js";import{c as R}from"./field.anatomy-Ze19KRbA.js";import{b as P,r as v,bm as O}from"./types-2y-X5aQn.js";import{J as H}from"./index-CluwUGD1.js";import{J as L}from"./index-GMG8mY01.js";import{R as V}from"./index-DH0GEJX9.js";import{B as A}from"./box-DMcbo_cE.js";import{C}from"./container-BotK6VuJ.js";import{V as I}from"./v-stack-QJg7n52G.js";import{H as F}from"./heading-BGvs0cd3.js";import{T as U}from"./text-DJUdolDr.js";import"./jsx-runtime-Bw5QeaCk.js";import"./schemas-LaxcQh7r.js";import"./index-ZS65BhKO.js";import"./iconBase-BtwG8oUN.js";import"./button-Dz2diCo_.js";import"./h-stack-BoRIBf53.js";import"./stack-DVtSLI4T.js";import"./index-DTSGLcC3.js";import"./simple-grid-D7DxtwhU.js";var _=R("toast").parts("group","root","title","description","actionTrigger","closeTrigger");_.build();var $=(s,c)=>({...c,...P(s)});function z(s){const c=$(s,{placement:"bottom",overlap:!1,max:24,gap:16,offsets:"1rem",hotkey:["altKey","KeyT"],removeDelay:200,pauseOnPageIdle:!0});let u=[],t=[],m=new Set,g=[];const f=e=>(u.push(e),()=>{const r=u.indexOf(e);u.splice(r,1)}),n=e=>(u.forEach(r=>r(e)),e),y=e=>{if(t.length>=c.max){g.push(e);return}n(e),t.unshift(e)},b=()=>{for(;g.length>0&&t.length<c.max;){const e=g.shift();e&&(n(e),t.unshift(e))}},o=e=>{const r=e.id??`toast:${O()}`,p=t.find(i=>i.id===r);return m.has(r)&&m.delete(r),p?t=t.map(i=>i.id===r?n({...i,...e,id:r}):i):y({id:r,duration:c.duration,removeDelay:c.removeDelay,type:"info",...e,stacked:!c.overlap,gap:c.gap}),r},x=e=>(m.add(e),e?(u.forEach(r=>r({id:e,dismiss:!0})),t=t.filter(r=>r.id!==e),b()):(t.forEach(r=>{u.forEach(p=>p({id:r.id,dismiss:!0}))}),t=[],g=[]),e);return{attrs:c,subscribe:f,create:o,update:(e,r)=>o({id:e,...r}),remove:x,dismiss:e=>{e!=null?t=t.map(r=>r.id===e?n({...r,message:"DISMISS"}):r):t=t.map(r=>n({...r,message:"DISMISS"}))},error:e=>o({...e,type:"error"}),success:e=>o({...e,type:"success"}),info:e=>o({...e,type:"info"}),warning:e=>o({...e,type:"warning"}),loading:e=>o({...e,type:"loading"}),getVisibleToasts:()=>t.filter(e=>!m.has(e.id)),getCount:()=>t.length,promise:(e,r,p={})=>{if(!r)return;let i;r.loading!==void 0&&(i=o({...p,...r.loading,promise:e,type:"loading"}));let S=i!==void 0,h;const k=v(e).then(async a=>{if(h=["resolve",a],B(a)&&!a.ok){S=!1;const d=v(r.error,`HTTP Error! status: ${a.status}`);o({...p,...d,id:i,type:"error"})}else if(r.success!==void 0){S=!1;const d=v(r.success,a);o({...p,...d,id:i,type:"success"})}}).catch(async a=>{if(h=["reject",a],r.error!==void 0){S=!1;const d=v(r.error,a);o({...p,...d,id:i,type:"error"})}}).finally(()=>{var a;S&&(x(i),i=void 0),(a=r.finally)==null||a.call(r)});return{id:i,unwrap:()=>new Promise((a,d)=>k.then(()=>h[0]==="reject"?d(h[1]):a(h[1])).catch(d))}},pause:e=>{e!=null?t=t.map(r=>r.id===e?n({...r,message:"PAUSE"}):r):t=t.map(r=>n({...r,message:"PAUSE"}))},resume:e=>{e!=null?t=t.map(r=>r.id===e?n({...r,message:"RESUME"}):r):t=t.map(r=>n({...r,message:"RESUME"}))},isVisible:e=>!m.has(e)&&!!t.find(r=>r.id===e),isDismissed:e=>m.has(e),expand:()=>{t=t.map(e=>n({...e,stacked:!0}))},collapse:()=>{t=t.map(e=>n({...e,stacked:!1}))}}}var B=s=>s&&typeof s=="object"&&"ok"in s&&typeof s.ok=="boolean"&&"status"in s&&typeof s.status=="number";const K=s=>z(s),E=K({placement:"bottom-end",pauseOnPageIdle:!0});async function j(s){return!s||s.trim().length===0?{success:!1,error:"会議IDが入力されていません"}:s.length<3?{success:!1,error:"無効な会議IDです"}:{success:!0,meetingId:s}}const N=[{id:"abc123",name:"今日のランチドラフト",lastJoined:"2時間前"},{id:"def456",name:"映画選びドラフト",lastJoined:"1日前"},{id:"ghi789",name:"チームドラフト",lastJoined:"3日前"}],Q=()=>{const[s,c]=w.useState(null),[u,t]=w.useState(!1),m=async f=>{var n;t(!0);try{let y=f.meetingInput.trim();const b=f.meetingInput.match(/\/(entry|lobby)\/([a-zA-Z0-9]+)/);b&&(y=b[2]);const o=await j(y);if(o.success)window.location.href=`/lobby/${o.meetingId}`;else{const x=(n=o.error)!=null&&n.includes("見つから")?"参加コードが見つかりませんでした。主催者に確認してみてください。":"参加できませんでした。参加コードを確認してください。";E.create({title:"参加できませんでした",description:x,type:"error",duration:5e3})}}catch(y){console.error("参加エラー:",y),E.create({title:"接続エラー",description:"接続に問題が発生しました。しばらく待ってから再度お試しください。",type:"error",duration:5e3})}finally{t(!1)}},g=async f=>{c(f);try{const n=await j(f);n.success?window.location.href=`/lobby/${n.meetingId}`:E.create({title:"参加できませんでした",description:"グループが見つかりませんでした。",type:"error",duration:5e3})}catch(n){console.error("参加エラー:",n),E.create({title:"参加エラー",description:"参加できませんでした。",type:"error",duration:5e3})}finally{c(null)}};return l.jsx(A,{minHeight:"100vh",bg:"bg",children:l.jsx(C,{maxW:"container.md",py:{base:4,md:8},children:l.jsxs(I,{gap:{base:6,md:8},align:"stretch",children:[l.jsxs(I,{gap:2,textAlign:"center",children:[l.jsx(F,{as:"h1",size:{base:"lg",md:"xl"},fontWeight:"bold",color:"gray.800",_dark:{color:"gray.100"},children:"グループに参加"}),l.jsx(U,{fontSize:{base:"sm",md:"md"},color:"gray.600",_dark:{color:"gray.400"},children:"参加コードやURLを入力してください"})]}),l.jsx(H,{onSubmit:m,isLoading:u}),l.jsx(V,{meetings:N,onJoinMeeting:g,loadingMeetingId:s}),l.jsx(L,{})]})})})},Pe={title:"Features/Join/JoinPage",component:Q,parameters:{layout:"fullscreen"}},T={};var J,M,D;T.parameters={...T.parameters,docs:{...(J=T.parameters)==null?void 0:J.docs,source:{originalSource:"{}",...(D=(M=T.parameters)==null?void 0:M.docs)==null?void 0:D.source}}};const Oe=["Default"];export{T as Default,Oe as __namedExportsOrder,Pe as default};

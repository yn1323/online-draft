import{c as H,p as Ie,m as ze,a as Ke}from"./mockData-DISdYL5i.js";import{j as n,c as Xe,f as Ge,m as Qe}from"./stack-BPGBxmP7.js";import{u as Je}from"./index-yHYUIvBd.js";import{r as g}from"./index-BXymfbzT.js";import{L as Ye,a as Ze}from"./index-C8TKjGAI.js";import{L as et}from"./index-Bvw4ip2W.js";import{q as Ee,o as Se,w as Z,c as k,a as Pe,d as ee,s as te,b as T,e as tt}from"./index.esm2017-mzQehXGw.js";import{d as $}from"./firebase-DBrNdAmE.js";import{u as st}from"./useRealtimeUsers-n9Hs04w7.js";import{C as se}from"./index-_b9geCRB.js";import{C as re}from"./index-CZnazTnF.js";import{C as ae}from"./index-j8x00CI5.js";import{u as rt,I as oe}from"./index-0KQLik0r.js";import{u as at,O as ne}from"./index-D2gX_IhQ.js";import{P as ie}from"./index-CDgjL83O.js";import{u as ot}from"./use-breakpoint-B2ao55g-.js";import{V as q}from"./v-stack-Dfms-mlT.js";import{B as x}from"./box-BF69sWHg.js";import{T as A}from"./text-CvVCgmJx.js";import{H as ce}from"./h-stack-CXTYcpFY.js";import{C as Fe}from"./container-BeF7NZEH.js";import{G as nt}from"./grid-mntVVhnA.js";import{c as it}from"./create-slot-recipe-context-BnxH4US7.js";import{c as U,u as ct,a as lt,b as ut,n as dt}from"./index-Brkr_dpc.js";import{u as ft,s as Ve,R as je}from"./render-strategy-Bdhnioqe.js";import{c as pt,a as F,b as mt}from"./factory-GA1w9YC2.js";import{c as gt}from"./index-BRNWFSEf.js";import{I as V,J as I,K as ht,E as bt,L as yt,H as vt,N as Ct,o as xt,O as wt,P as Tt,Q as Rt,r as S,R as It,S as Et,T as St,w as Pt,U as Ft,q as Vt}from"./index-Bkt13QoG.js";import{p as jt,q as At}from"./index-BEZemFFB.js";import{c as K}from"./index-CrjboX4Z.js";import{u as _t,P as Dt}from"./responsive-modal-DK_jUbPM.js";import"./jsx-runtime-Bw5QeaCk.js";import"./index-C0w2AICy.js";import"./_interop_require_wildcard-BpaVepTj.js";import"./spinner-BfFBc7wa.js";import"./index-DAbNv4Ic.js";import"./button-DJPprnzD.js";import"./attr-C3Jtgmrz.js";import"./index-Bh4LOzbh.js";import"./index-DryDucYP.js";import"./index-DGKHe-6Q.js";import"./image-context-B4PdNff0.js";import"./index-CmCyOxug.js";import"./index-Cta6h1Mu.js";import"./card-DlhQdIZJ.js";import"./zod-Bx0w6FpW.js";import"./types-DwQkBYn-.js";import"./index-5wYTFD69.js";import"./icon-button-Cau_blD8.js";import"./index-7Dro8rd9.js";function Ot(e,t){const[r,s]=g.useState(e);return g.useEffect(()=>{const o=setTimeout(()=>{s(e)},t);return()=>{clearTimeout(o)}},[e,t]),r}const[Ae,W]=pt({name:"TabsContext",hookName:"useTabsContext",providerName:"<TabsProvider />"}),_e=g.forwardRef((e,t)=>{const[r,s]=U()(e,["value"]),o=W(),a=ft(),i=_t({...a,present:Ot(o.value===e.value,0),immediate:!0}),d=V(o.getContentProps(r),i.getPresenceProps(),s);return n.jsx(Dt,{value:i,children:i.unmounted?null:n.jsx(F.div,{...d,ref:mt(i.ref,t)})})});_e.displayName="TabContent";const De=g.forwardRef((e,t)=>{const r=W(),s=V(r.getIndicatorProps(),e);return n.jsx(F.div,{...s,ref:t})});De.displayName="TabIndicator";const Oe=g.forwardRef((e,t)=>{const r=W(),s=V(r.getListProps(),e);return n.jsx(F.div,{...s,ref:t})});Oe.displayName="TabList";const Be=g.forwardRef((e,t)=>{const[r,s]=U()(e,["disabled","value"]),o=W(),a=V(o.getTriggerProps(r),s);return n.jsx(F.button,{...a,ref:t})});Be.displayName="TabTrigger";var Bt=gt("tabs").parts("root","list","trigger","content","indicator"),_=Bt.build(),Nt=e=>{var t;return((t=e.ids)==null?void 0:t.root)??`tabs:${e.id}`},O=e=>{var t;return((t=e.ids)==null?void 0:t.list)??`tabs:${e.id}:list`},z=(e,t)=>{var r;return((r=e.ids)==null?void 0:r.content)??`tabs:${e.id}:content-${t}`},E=(e,t)=>{var r;return((r=e.ids)==null?void 0:r.trigger)??`tabs:${e.id}:trigger-${t}`},Ne=e=>{var t;return((t=e.ids)==null?void 0:t.indicator)??`tabs:${e.id}:indicator`},Lt=e=>e.getById(O(e)),Mt=(e,t)=>e.getById(z(e,t)),L=(e,t)=>e.getById(E(e,t)),le=e=>e.getById(Ne(e)),B=e=>{const r=`[role=tab][data-ownedby='${CSS.escape(O(e))}']:not([disabled])`;return Vt(Lt(e),r)},kt=e=>At(B(e)),$t=e=>jt(B(e)),Ut=(e,t)=>St(B(e),E(e,t.value),t.loopFocus),Wt=(e,t)=>Et(B(e),E(e,t.value),t.loopFocus),Le=e=>({left:(e==null?void 0:e.offsetLeft)??0,top:(e==null?void 0:e.offsetTop)??0,width:(e==null?void 0:e.offsetWidth)??0,height:(e==null?void 0:e.offsetHeight)??0}),qt=(e,t)=>{const r=Ft(B(e),E(e,t));return Me(Le(r))},Me=e=>({width:`${e.width}px`,height:`${e.height}px`,left:`${e.left}px`,top:`${e.top}px`});function Ht(e,t){const{state:r,send:s,context:o,prop:a,scope:i}=e,d=a("translations"),h=r.matches("focused"),f=a("orientation")==="vertical",p=a("orientation")==="horizontal",m=a("composite");function u(l){return{selected:o.get("value")===l.value,focused:o.get("focusedValue")===l.value,disabled:!!l.disabled}}return{value:o.get("value"),focusedValue:o.get("focusedValue"),setValue(l){s({type:"SET_VALUE",value:l})},clearValue(){s({type:"CLEAR_VALUE"})},setIndicatorRect(l){const c=E(i,l);s({type:"SET_INDICATOR_RECT",id:c})},syncTabIndex(){s({type:"SYNC_TAB_INDEX"})},selectNext(l){s({type:"TAB_FOCUS",value:l,src:"selectNext"}),s({type:"ARROW_NEXT",src:"selectNext"})},selectPrev(l){s({type:"TAB_FOCUS",value:l,src:"selectPrev"}),s({type:"ARROW_PREV",src:"selectPrev"})},focus(){var c;const l=o.get("value");l&&((c=L(i,l))==null||c.focus())},getRootProps(){return t.element({..._.root.attrs,id:Nt(i),"data-orientation":a("orientation"),"data-focus":I(h),dir:a("dir")})},getListProps(){return t.element({..._.list.attrs,id:O(i),role:"tablist",dir:a("dir"),"data-focus":I(h),"aria-orientation":a("orientation"),"data-orientation":a("orientation"),"aria-label":d==null?void 0:d.listLabel,onKeyDown(l){if(l.defaultPrevented||!yt(l)||vt(l))return;const c={ArrowDown(){p||s({type:"ARROW_NEXT",key:"ArrowDown"})},ArrowUp(){p||s({type:"ARROW_PREV",key:"ArrowUp"})},ArrowLeft(){f||s({type:"ARROW_PREV",key:"ArrowLeft"})},ArrowRight(){f||s({type:"ARROW_NEXT",key:"ArrowRight"})},Home(){s({type:"HOME"})},End(){s({type:"END"})}};let y=Ct(l,{dir:a("dir"),orientation:a("orientation")});const C=c[y];if(C){l.preventDefault(),C(l);return}}})},getTriggerState:u,getTriggerProps(l){const{value:c,disabled:y}=l,C=u(l);return t.button({..._.trigger.attrs,role:"tab",type:"button",disabled:y,dir:a("dir"),"data-orientation":a("orientation"),"data-disabled":I(y),"aria-disabled":y,"data-value":c,"aria-selected":C.selected,"data-selected":I(C.selected),"data-focus":I(C.focused),"aria-controls":C.selected?z(i,c):void 0,"data-ownedby":O(i),"data-ssr":I(o.get("ssr")),id:E(i,c),tabIndex:C.selected&&m?0:-1,onFocus(){s({type:"TAB_FOCUS",value:c})},onBlur(v){const w=v.relatedTarget;(w==null?void 0:w.getAttribute("role"))!=="tab"&&s({type:"TAB_BLUR"})},onClick(v){v.defaultPrevented||ht(v)||y||(bt()&&v.currentTarget.focus(),s({type:"TAB_CLICK",value:c}))}})},getContentProps(l){const{value:c}=l,y=o.get("value")===c;return t.element({..._.content.attrs,dir:a("dir"),id:z(i,c),tabIndex:m?0:-1,"aria-labelledby":E(i,c),role:"tabpanel","data-ownedby":O(i),"data-selected":I(y),"data-orientation":a("orientation"),hidden:!y})},getIndicatorProps(){const l=o.get("indicatorRect"),c=o.get("indicatorTransition");return t.element({id:Ne(i),..._.indicator.attrs,dir:a("dir"),"data-orientation":a("orientation"),style:{"--transition-property":"left, right, top, bottom, width, height","--left":l.left,"--top":l.top,"--width":l.width,"--height":l.height,position:"absolute",willChange:"var(--transition-property)",transitionProperty:"var(--transition-property)",transitionDuration:c?"var(--transition-duration, 150ms)":"0ms",transitionTimingFunction:"var(--transition-timing-function)",[p?"left":"top"]:p?"var(--left)":"var(--top)"}})}}}var{createMachine:zt}=xt(),Kt=zt({props({props:e}){return{dir:"ltr",orientation:"horizontal",activationMode:"automatic",loopFocus:!0,composite:!0,navigate(t){Pt(t.node)},defaultValue:null,...e}},initialState(){return"idle"},context({prop:e,bindable:t}){return{value:t(()=>({defaultValue:e("defaultValue"),value:e("value"),onChange(r){var s;(s=e("onValueChange"))==null||s({value:r})}})),focusedValue:t(()=>({defaultValue:e("value")||e("defaultValue"),sync:!0,onChange(r){var s;(s=e("onFocusChange"))==null||s({focusedValue:r})}})),ssr:t(()=>({defaultValue:!0})),indicatorTransition:t(()=>({defaultValue:!1})),indicatorRect:t(()=>({defaultValue:{left:"0px",top:"0px",width:"0px",height:"0px"}}))}},watch({context:e,prop:t,track:r,action:s}){r([()=>e.get("value")],()=>{s(["allowIndicatorTransition","syncIndicatorRect","syncTabIndex","navigateIfNeeded"])}),r([()=>t("dir"),()=>t("orientation")],()=>{s(["syncIndicatorRect"])})},on:{SET_VALUE:{actions:["setValue"]},CLEAR_VALUE:{actions:["clearValue"]},SET_INDICATOR_RECT:{actions:["setIndicatorRect"]},SYNC_TAB_INDEX:{actions:["syncTabIndex"]}},entry:["syncIndicatorRect","syncTabIndex","syncSsr"],exit:["cleanupObserver"],states:{idle:{on:{TAB_FOCUS:{target:"focused",actions:["setFocusedValue"]},TAB_CLICK:{target:"focused",actions:["setFocusedValue","setValue"]}}},focused:{on:{TAB_CLICK:{actions:["setFocusedValue","setValue"]},ARROW_PREV:[{guard:"selectOnFocus",actions:["focusPrevTab","selectFocusedTab"]},{actions:["focusPrevTab"]}],ARROW_NEXT:[{guard:"selectOnFocus",actions:["focusNextTab","selectFocusedTab"]},{actions:["focusNextTab"]}],HOME:[{guard:"selectOnFocus",actions:["focusFirstTab","selectFocusedTab"]},{actions:["focusFirstTab"]}],END:[{guard:"selectOnFocus",actions:["focusLastTab","selectFocusedTab"]},{actions:["focusLastTab"]}],TAB_FOCUS:{actions:["setFocusedValue"]},TAB_BLUR:{target:"idle",actions:["clearFocusedValue"]}}}},implementations:{guards:{selectOnFocus:({prop:e})=>e("activationMode")==="automatic"},actions:{selectFocusedTab({context:e,prop:t}){S(()=>{const r=e.get("focusedValue");if(!r)return;const o=t("deselectable")&&e.get("value")===r?null:r;e.set("value",o)})},setFocusedValue({context:e,event:t,flush:r}){t.value!=null&&r(()=>{e.set("focusedValue",t.value)})},clearFocusedValue({context:e}){e.set("focusedValue",null)},setValue({context:e,event:t,prop:r}){const s=r("deselectable")&&e.get("value")===e.get("focusedValue");e.set("value",s?null:t.value)},clearValue({context:e}){e.set("value",null)},focusFirstTab({scope:e}){S(()=>{var t;(t=kt(e))==null||t.focus()})},focusLastTab({scope:e}){S(()=>{var t;(t=$t(e))==null||t.focus()})},focusNextTab({context:e,prop:t,scope:r,event:s}){const o=s.value??e.get("focusedValue");if(!o)return;const a=Ut(r,{value:o,loopFocus:t("loopFocus")});S(()=>{t("composite")?a==null||a.focus():(a==null?void 0:a.dataset.value)!=null&&e.set("focusedValue",a.dataset.value)})},focusPrevTab({context:e,prop:t,scope:r,event:s}){const o=s.value??e.get("focusedValue");if(!o)return;const a=Wt(r,{value:o,loopFocus:t("loopFocus")});S(()=>{t("composite")?a==null||a.focus():(a==null?void 0:a.dataset.value)!=null&&e.set("focusedValue",a.dataset.value)})},syncTabIndex({context:e,scope:t}){S(()=>{const r=e.get("value");if(!r)return;const s=Mt(t,r);if(!s)return;It(s).length>0?s.removeAttribute("tabindex"):s.setAttribute("tabindex","0")})},cleanupObserver({refs:e}){const t=e.get("indicatorCleanup");t&&t()},allowIndicatorTransition({context:e}){e.set("indicatorTransition",!0)},setIndicatorRect({context:e,event:t,scope:r}){const s=t.id??e.get("value");if(!le(r))return;if(!s){e.set("indicatorTransition",!1);return}L(r,s)&&(e.set("indicatorRect",qt(r,s)),Rt(()=>{e.set("indicatorTransition",!1)}))},syncSsr({context:e}){e.set("ssr",!1)},syncIndicatorRect({context:e,refs:t,scope:r}){const s=t.get("indicatorCleanup");s&&s();const o=e.get("value");if(!o){e.set("indicatorTransition",!1);return}const a=L(r,o),i=le(r);if(!a||!i)return;const d=Tt([a],{measure(h){return Le(h)},onEntry({rects:h}){const[f]=h;e.set("indicatorRect",Me(f))}});t.set("indicatorCleanup",d)},navigateIfNeeded({context:e,prop:t,scope:r}){var a;const s=e.get("value");if(!s)return;const o=L(r,s);wt(o)&&((a=t("navigate"))==null||a({value:s,node:o,href:o.href}))}}}});K()(["activationMode","composite","deselectable","dir","getRootNode","id","ids","loopFocus","navigate","onFocusChange","onValueChange","orientation","translations","value","defaultValue"]);K()(["disabled","value"]);K()(["value"]);const Xt=e=>{const t=g.useId(),{getRootNode:r}=ct(),{dir:s}=lt(),o={id:t,dir:s,getRootNode:r,...e},a=ut(Kt,o);return Ht(a,dt)},ke=g.forwardRef((e,t)=>{const[r,s]=Ve(e),[o,a]=U()(s,["activationMode","composite","defaultValue","deselectable","id","ids","loopFocus","navigate","onFocusChange","onValueChange","orientation","translations","value"]),i=Xt(o),d=V(i.getRootProps(),a);return n.jsx(Ae,{value:i,children:n.jsx(je,{value:r,children:n.jsx(F.div,{...d,ref:t})})})});ke.displayName="TabsRoot";const $e=g.forwardRef((e,t)=>{const[r,s]=Ve(e),[{value:o},a]=U()(s,["value"]),i=V(o.getRootProps(),a);return n.jsx(Ae,{value:o,children:n.jsx(je,{value:r,children:n.jsx(F.div,{...i,ref:t})})})});$e.displayName="TabsRootProvider";function ue(e){return Qe(e,t=>t==="auto"?"auto":`span ${t}/span ${t}`)}const de=g.forwardRef(function(t,r){const{area:s,colSpan:o,colStart:a,colEnd:i,rowEnd:d,rowSpan:h,rowStart:f,...p}=t,m=Xe({gridArea:s,gridColumn:ue(o),gridRow:ue(h),gridColumnStart:a,gridColumnEnd:i,gridRowStart:f,gridRowEnd:d});return n.jsx(Ge.div,{ref:r,css:m,...p})}),{withProvider:Ue,withContext:N}=it({key:"tabs"});Ue($e,"root",{forwardAsChild:!0});const Gt=Ue(ke,"root",{forwardAsChild:!0}),fe=N(Be,"trigger",{forwardAsChild:!0}),pe=N(_e,"content",{forwardAsChild:!0});N("div","contentGroup");const Qt=N(Oe,"list",{forwardAsChild:!0});N(De,"indicator",{forwardAsChild:!0});const Jt=(e,t,r)=>{const[s,o]=g.useState([]),[a,i]=g.useState(!0),[d,h]=g.useState(null);return g.useEffect(()=>{if(!e){o([]),i(!1);return}const f=Ee(k($,"app/onlinedraft/log"),Z("groupId","==",e),Z("deleteFlg","==",!1),Se("date","asc"));return Pe(f,m=>{const u=m.docs.map(l=>{var j;const c=l.data(),C=(((j=c.date)==null?void 0:j.toDate())||new Date).toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit"}),v=c.userId==="system"||!c.userId,w=(t==null?void 0:t[c.userId])||{name:v?"システム":"匿名ユーザー",avatar:v?"99":"1"};return{id:l.id,userName:w.name,avatar:w.avatar,content:c.message,timestamp:C,isSystem:v,isCurrentUser:!v&&c.userId===r}});o(u),i(!1),h(null)},m=>{console.error("チャットメッセージ監視エラー:",m),h(m),i(!1)})},[e,t,r]),{messages:s,loading:a,error:d}},Yt=e=>{const[t,r]=g.useState([]),[s,o]=g.useState(!0),[a,i]=g.useState(null);return g.useEffect(()=>{if(!e){r([]),o(!1);return}const d=Ee(k($,"app/onlinedraft/selection"),Se("createdAt","desc"));return Pe(d,f=>{const p=[];f.docs.forEach(m=>{const l=m.data().selection.filter(c=>c.groupId===e);p.push(...l)}),r(p),o(!1),i(null)},f=>{console.error("選択データの取得エラー:",f),i(f),o(!1)})},[e]),{selections:t,loading:s,error:a}},Zt=()=>{const e=k($,"app/onlinedraft/log"),t=g.useCallback(async(s,o,a)=>{if(!s.trim())throw new Error("グループIDが必要です");if(!o.trim())throw new Error("ユーザーIDが必要です");if(!a.trim())throw new Error("メッセージを入力してください");if(a.length>200)throw new Error("メッセージは200文字以内で入力してください");const i={groupId:s.trim(),userId:o.trim(),message:a.trim(),deleteFlg:!1};try{const d=ee(e);await te(d,{...i,createdAt:T(),date:T(),updatedAt:T()})}catch(d){throw d instanceof Error?new Error(`メッセージ送信に失敗しました: ${d.message}`):new Error("メッセージ送信中に予期しないエラーが発生しました")}},[e]),r=g.useCallback(async(s,o)=>{if(!s.trim())throw new Error("グループIDが必要です");if(!o.trim())throw new Error("メッセージを入力してください");const a={groupId:s.trim(),userId:"system",message:o.trim(),deleteFlg:!1};try{const i=ee(e);await te(i,{...a,createdAt:T(),date:T(),updatedAt:T()})}catch(i){throw i instanceof Error?new Error(`システムメッセージ送信に失敗しました: ${i.message}`):new Error("システムメッセージ送信中に予期しないエラーが発生しました")}},[e]);return{sendMessage:t,sendSystemMessage:r,logCollection:e}},es=(e,t)=>{const[r,s]=g.useState(!1),[o,a]=g.useState(null),{sendMessage:i}=Zt();return{loading:r,error:o,sendMessage:async h=>{if(h.trim()){s(!0),a(null);try{await i(e,t,h)}catch(f){throw a(f instanceof Error?f.message:"メッセージ送信に失敗しました"),f}finally{s(!1)}}}}},ts=()=>{const e=k($,"app/onlinedraft/selection");return{createSelection:g.useCallback(async(r,s,o,a,i)=>{try{const d=Math.floor(Math.random()*1e6);return(await tt(e,{selection:[{item:o,comment:a,round:i,userId:s,groupId:r,randomNumber:d}],createdAt:T(),updatedAt:T()})).id}catch(d){throw console.error("選択データの作成に失敗しました:",d),d}},[e]),selectionCollection:e}},ss=(e,t,r)=>{const{createSelection:s}=ts(),[o,a]=g.useState(!1),[i,d]=g.useState(null);return{loading:o,error:i,selectItem:async(p,m)=>{a(!0),d(null);try{await s(e,t,p,m||"",r)}catch(u){throw d(u instanceof Error?u.message:"アイテム選択に失敗しました"),u}finally{a(!1)}},editPick:async p=>{a(!0),d(null);try{console.log("ピック編集:",p),await new Promise(m=>setTimeout(m,1e3))}catch(m){throw d(m instanceof Error?m.message:"ピック編集に失敗しました"),m}finally{a(!1)}}}},rs=(e,t,r)=>{const[s,o]=g.useState(!1),[a,i]=g.useState(null);return{loading:s,error:a,executeOpenResult:async()=>{o(!0),i(null);try{console.log("開票処理実行"),await new Promise(f=>setTimeout(f,2e3))}catch(f){throw i(f instanceof Error?f.message:"開票処理に失敗しました"),f}finally{o(!1)}},checkParticipantStatus:async()=>{try{const f=t.filter(u=>u.round===r).length,p=f===e.length,m=e.length-f;return{allCompleted:p,pendingCount:m}}catch(f){throw i(f instanceof Error?f.message:"状況確認に失敗しました"),f}}}},M=({currentRound:e,participants:t,pastResults:r,realtimeChatMessages:s,selections:o,groupId:a,userId:i})=>{const d=ot({base:!0,md:!1}),[h,f]=g.useState("draft"),p=rt(),m=at(),[u,l]=g.useState(null),c=o.find(b=>b.userId===i&&b.round===e),{selectItem:y}=ss(a,i,e),{sendMessage:C}=es(a,i),{executeOpenResult:v,checkParticipantStatus:w}=rs(t,o,e),j=async b=>{try{await y(b.item,b.comment)}catch(R){console.error("アイテム選択エラー:",R)}},X=async b=>{try{await y(b.item,b.comment),l(null),p.close()}catch(R){console.error("編集保存エラー:",R)}},G=(b,R,We,qe,He)=>{l({round:b,playerId:R,playerName:We,currentPick:qe,category:He}),p.open()},Q=async()=>{try{(await w()).allCompleted?await v():m.open()}catch(b){console.error("開票処理エラー:",b)}},J=async()=>{try{await v(),m.close()}catch(b){console.error("開票実行エラー:",b)}},Y=async b=>{try{await C(b)}catch(R){console.error("チャット送信エラー:",R)}};return d?n.jsxs(q,{h:"100vh",gap:0,children:[n.jsx(x,{bg:"white",borderBottom:"1px",borderColor:"gray.200",p:4,w:"full",position:"sticky",top:0,zIndex:10,children:n.jsx(A,{fontSize:"lg",fontWeight:"bold",textAlign:"center",children:"オンラインドラフト会議"})}),n.jsxs(Gt,{value:h,onValueChange:b=>f(b.value),flex:1,display:"flex",flexDirection:"column",w:"full",overflow:"hidden",children:[n.jsxs(Qt,{bg:"gray.50",borderBottom:"2px solid",borderColor:"gray.200",flexShrink:0,children:[n.jsx(fe,{value:"draft",flex:1,py:3,px:4,_selected:{bg:"white",color:"blue.600",borderBottom:"2px solid",borderColor:"blue.500",fontWeight:"bold"},transition:"all 0.15s ease",children:n.jsxs(ce,{gap:2,justify:"center",w:"full",children:[n.jsx(Ye,{size:18}),n.jsx(A,{fontSize:"sm",children:"取得リスト"})]})}),n.jsx(fe,{value:"chat",flex:1,py:3,px:4,_selected:{bg:"white",color:"blue.600",borderBottom:"2px solid",borderColor:"blue.500",fontWeight:"bold"},transition:"all 0.15s ease",children:n.jsxs(ce,{gap:2,justify:"center",w:"full",children:[n.jsx(Ze,{size:18}),n.jsx(A,{fontSize:"sm",children:"チャット"})]})})]}),n.jsxs(x,{flex:1,overflow:"hidden",minH:0,children:[n.jsx(pe,{value:"draft",h:"full",overflow:"auto",children:n.jsxs(q,{gap:3,p:3,children:[n.jsx(ae,{participants:t,currentRound:e,variant:"sp",currentUserId:i,selections:o,onItemSelect:p.open,onOpenResult:Q}),n.jsx(ie,{pastResults:r,participants:t,variant:"sp",onEditClick:G})]})}),n.jsx(pe,{value:"chat",h:"full",overflow:"hidden",display:"flex",flexDirection:"column",children:n.jsx(x,{flex:1,overflow:"auto",p:3,children:n.jsx(re,{messages:s})})})]})]}),h==="chat"&&n.jsx(x,{bg:"white",borderTop:"1px",borderColor:"gray.200",p:3,w:"full",position:"sticky",bottom:0,children:n.jsx(se,{onSendMessage:Y})}),n.jsx(oe,{isOpen:p.isOpen,onClose:()=>{p.close(),l(null)},onSubmit:u?X:j,modalTitle:u?"ピックを編集":c?"選択を編集":"アイテムを選択",defaultItem:(u==null?void 0:u.currentPick)||(c==null?void 0:c.item),defaultComment:(u==null?void 0:u.category)||(c==null?void 0:c.comment),editContext:u?{round:u.round,playerName:u.playerName}:void 0}),n.jsx(ne,{isOpen:m.isOpen,onClose:m.close,onExecuteOpenResult:J})]}):n.jsxs(x,{bg:"gray.50",minH:"100vh",py:8,children:[n.jsxs(Fe,{maxW:"container.xl",children:[n.jsx(x,{mb:6,children:n.jsx(A,{fontSize:"2xl",fontWeight:"bold",color:"gray.800",children:"オンラインドラフト会議"})}),n.jsxs(nt,{templateColumns:"7fr 3fr",gap:6,h:"calc(100vh - 130px)",children:[n.jsx(de,{h:"100%",children:n.jsxs(q,{gap:4,h:"100%",w:"full",align:"stretch",children:[n.jsx(ae,{participants:t,currentRound:e,variant:"pc",currentUserId:i,selections:o,onItemSelect:p.open,onOpenResult:Q}),n.jsx(ie,{pastResults:r,participants:t,variant:"pc",onEditClick:G})]})}),n.jsx(de,{h:"100%",children:n.jsxs(x,{h:"100%",maxH:"calc(100vh - 130px)",bg:"white",boxShadow:"lg",p:4,borderRadius:"lg",display:"flex",flexDirection:"column",overflow:"hidden",children:[n.jsx(A,{fontSize:"lg",fontWeight:"bold",mb:4,flexShrink:0,children:"チャット"}),n.jsx(x,{flex:"1",overflow:"auto",mb:3,minH:0,children:n.jsx(re,{messages:s})}),n.jsx(x,{flexShrink:0,children:n.jsx(se,{onSendMessage:Y})})]})})]})]}),n.jsx(oe,{isOpen:p.isOpen,onClose:()=>{p.close(),l(null)},onSubmit:u?X:j,modalTitle:u?"ピックを編集":c?"選択を編集":"アイテムを選択",defaultItem:(u==null?void 0:u.currentPick)||(c==null?void 0:c.item),defaultComment:(u==null?void 0:u.category)||(c==null?void 0:c.comment),editContext:u?{round:u.round,playerName:u.playerName}:void 0}),n.jsx(ne,{isOpen:m.isOpen,onClose:m.close,onExecuteOpenResult:J})]})},me=({groupId:e})=>{const t=Je(),[r,s]=g.useState("");g.useEffect(()=>{const p=sessionStorage.getItem("onlinedraft_user_id");p?s(p):t.push(`/lobby/${e}`)},[e,t]);const{users:o,loading:a}=st(e),i=g.useMemo(()=>o.reduce((p,m)=>(p[m.userId]={name:m.userName,avatar:m.avatar},p),{}),[o]),{messages:d}=Jt(e,i,r),{selections:h}=Yt(e);if(!r||a)return n.jsx(x,{bg:"gray.50",minH:"100vh",py:[4,8],children:n.jsx(Fe,{maxW:"container.lg",children:n.jsx(et,{message:"ローディング中..."})})});const f=o.map(p=>{const m=h.find(u=>u.userId===p.userId&&u.round===H);return{id:p.userId,name:p.userName,avatar:p.avatar,acquisitions:[],currentPick:(m==null?void 0:m.item)||"選択中..."}});return n.jsx(M,{currentRound:H,participants:f,pastResults:Ie,realtimeChatMessages:d,selections:h,groupId:e,userId:r})};try{M.displayName="DraftPageInner",M.__docgenInfo={description:`ドラフト実行画面Innerコンポーネント（Presenter）
UI描画と状態管理を担当、新しいhooks構造を使用`,displayName:"DraftPageInner",props:{currentRound:{defaultValue:null,description:"",name:"currentRound",required:!0,type:{name:"number"}},participants:{defaultValue:null,description:"",name:"participants",required:!0,type:{name:"ParticipantType[]"}},pastResults:{defaultValue:null,description:"",name:"pastResults",required:!0,type:{name:"DraftRoundType[]"}},realtimeChatMessages:{defaultValue:null,description:"",name:"realtimeChatMessages",required:!0,type:{name:"ChatMessageUIType[]"}},selections:{defaultValue:null,description:"",name:"selections",required:!0,type:{name:"SelectionItemType[]"}},groupId:{defaultValue:null,description:"",name:"groupId",required:!0,type:{name:"string"}},userId:{defaultValue:null,description:"",name:"userId",required:!0,type:{name:"string"}}}}}catch{}try{me.displayName="DraftPage",me.__docgenInfo={description:`ドラフト実行画面コンポーネント（Container）
モックデータの提供のみを担当`,displayName:"DraftPage",props:{groupId:{defaultValue:null,description:"",name:"groupId",required:!0,type:{name:"string"}}}}}catch{}const er={title:"features/draft/DraftPage",component:M,parameters:{layout:"fullscreen"}},P={args:{currentRound:H,participants:Ke,pastResults:Ie,realtimeChatMessages:ze,selections:[],groupId:"test-group-id",userId:"test-user-id"}},D={args:{...P.args},parameters:{viewport:{defaultViewport:"mobile1"}}};var ge,he,be,ye,ve;P.parameters={...P.parameters,docs:{...(ge=P.parameters)==null?void 0:ge.docs,source:{originalSource:`{
  args: {
    currentRound,
    participants: mockParticipants,
    pastResults: pastDraftResults,
    realtimeChatMessages: mockChatMessages,
    selections: [],
    groupId: 'test-group-id',
    userId: 'test-user-id'
  }
}`,...(be=(he=P.parameters)==null?void 0:he.docs)==null?void 0:be.source},description:{story:`デフォルトのドラフトページ表示
新しいhooks構造を使用した純粋なUIテスト`,...(ve=(ye=P.parameters)==null?void 0:ye.docs)==null?void 0:ve.description}}};var Ce,xe,we,Te,Re;D.parameters={...D.parameters,docs:{...(Ce=D.parameters)==null?void 0:Ce.docs,source:{originalSource:`{
  args: {
    ...Default.args
  },
  parameters: {
    viewport: {
      defaultViewport: 'mobile1'
    }
  }
}`,...(we=(xe=D.parameters)==null?void 0:xe.docs)==null?void 0:we.source},description:{story:`SP表示の強制確認用
ビューポートを小さく設定してSP版レイアウトを確認`,...(Re=(Te=D.parameters)==null?void 0:Te.docs)==null?void 0:Re.description}}};const tr=["Default","SPLayout"];export{P as Default,D as SPLayout,tr as __namedExportsOrder,er as default};
